function fnValUserDetails(){try{var f=jq("#txtCustName");var g=jq("#txtEmail");var c=jq("#txtMobile");var a=jq("#chkIntMob");function b(){if(jq("#dSecContactDet").attr("data-mode")=="hide"){fnDoSwitchAcc("dSecContactDet");}}if(blnAcceptName){if(jq.trim(f.val())==""||jq.trim(f.val())==f.attr("placeholder")){fnCMsgDis("errDivMD","Name Required!","e");f.focus();b();return false;}else{if(fnVal.chkName(jq.trim(f.val()))==false){fnCMsgDis("errDivMD","Name Invalid!","e");f.focus();b();return false;}}}if(jq.trim(g.val())==""||jq.trim(g.val())=="Email address"){fnCMsgDis("errDivMD","Email Address Required!","e");g.focus();b();return false;}else{if(!fnVal.email(g.val())){fnCMsgDis("errDivMD","Email Address Invalid!","e");g.focus();b();return false;}}if(jq.trim(c.val())==""||jq.trim(c.val())=="Mobile number"){fnCMsgDis("errDivMD","Mobile Number Required!","e");c.focus();b();return false;}else{if(a.is(":checked")==true&&/^[0-9]\d{9,}$/.test(jq.trim(c.val()))==false){fnCMsgDis("errDivMD","Mobile Number Invalid!","e");c.focus();b();return false;}else{if(a.is(":checked")==false&&fnVal.mob(jq.trim(c.val()))==false){fnCMsgDis("errDivMD","Mobile Number Invalid!","e");c.focus();b();return false;}}}return true;}catch(d){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:d});}}function fnGetContactDetails(){try{var f=jq("#txtEmail");var b=jq("#txtMobile");var a=jq("#chkReg");var d=[];d.push("EMAIL="+jq.trim(f.val().toLowerCase()));d.push("MOBILE="+jq.trim(b.val()));d.push("MEMBER="+objCk.get({name:"ld",key:"MEMBERID"}));d.push("LSID="+objCk.get({name:"ld",key:"LSID"}));if(a.is(":checked")){d.push("AUTOREG=Y");}return"|"+d.join("|")+"|";}catch(c){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:c});}}function fnAllowNum(d){try{var g=d.which?d.which:d.keyCode;var c=[8,13,46,37,38,39,40];for(var b=48;b<=57;b++){c.push(b);}for(var b=96;b<=105;b++){c.push(b);}if(jq.inArray(g,c)>-1){return true;}if(d.ctrlKey){return true;}return false;}catch(f){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:f});}}function fnChkIntMob(){try{var a=jq("#chkIntMob");if(a.is(":checked")){jq("#txtMobPrefix").val("+");jq("#dIntMobNote").show();jq("#dIntMobLbl").css({color:"#4D4D4D"});}else{jq("#txtMobPrefix").val("+91");jq("#dIntMobNote").hide();jq("#dIntMobLbl").css({color:"#B8B8B8"});}}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}var objCk=new clsCookie();var isOfferApplied=false;var totGVAmt=0;var GVCounter=0;var maxTime=480;var contTransErrNo=0;var arrNoPriceVenues=["KTCT","RATC","PITG"];var lngGrandTotal=0;function fnPayLoad(){try{if(typeof(jq().mailcheck)!="undefined"){jq("#txtEmail").unbind("blur");jq("#txtEmail").bind("blur",function(){jq(this).mailcheck({suggested:function(c,b){jq("#dPayEmailSuggest").html("Did you mean <i><b><a href=\"javascript:;\" onclick=\"jq('#txtEmail').val('"+b.full+"');jq('#dPayEmailSuggest').hide();\">"+b.full+"</a></b></i>?").show();},empty:function(){jq("#dPayEmailSuggest").hide();}});});}jq("#txtCardNo").formatCardNumber({cardTypeClassElement:"#imgCardType"});jq("#txtCardNo_EMI").formatCardNumber({cardTypeClassElement:"#imgCardType_EMI"});jq("#dWhatCards_EMI").hover(function(b){switch(b.type){case"mouseenter":jq("#dWhatCardsTooltip_EMI").css({top:jq(this).position().top-70+jq("#dWhatCards_EMI").height(),left:jq(this).position().left-199});jq("#dWhatCardsTooltip_EMI").fadeIn("fast");break;case"mouseleave":jq("#dWhatCardsTooltip_EMI").fadeOut("fast");break;}});jq("#txtEmail, #txtMobile").setAltText();jq("#txtUserWallet, #txtPassWallet").doEnter({callback:fnLoginWallet});jq("#txtCheckPaybackNo, #txtCheckPaybackPin").doEnter({callback:fnCheckPaybackPoints});jq("#cmbCashCardType").bind("change",function(){var b=jq(this).val();jq("#liOxi, #liOxiCard, #liDone, #liBeam, #liItz, #liImint, #liAirtel, #liPayCashCard, #liYPayCash, #liVM2, #liMobiKwik, #liAmexExeClick, #liPayUMoney").hide();switch(b){case"OXI":jq("#liOxi").animate({height:"show",opacity:"show"},"fast");break;case"OXICARD":jq("#liOxiCard").animate({height:"show",opacity:"show"},"fast");break;case"DONE":jq("#liDone").animate({height:"show",opacity:"show"},"fast");break;case"BEAM":jq("#liBeam").animate({height:"show",opacity:"show"},"fast");break;case"ATL-NA":jq("#liAirtel").animate({height:"show",opactiy:"show"},"fast");break;case"PCH-NA":jq("#liPayCashCard").animate({height:"show",opactiy:"show"},"fast");break;case"ITZCASH":jq("#liItz").animate({height:"show",opacity:"show"},"fast");break;case"IMINTCARD":jq("#liImint").animate({height:"show",opacity:"show"},"fast");break;case"VM2-NA":jq("#liVM2").animate({height:"show",opacity:"show"},"fast");break;case"YPAY-NA":jq("#liYPayCash").animate({height:"show",opacity:"show"},"fast");break;case"MOBIKWIK":jq("#liMobiKwik").animate({height:"show",opacity:"show"},"fast");break;case"AMEXEZE":jq("#liAmexExeClick").animate({height:"show",opacity:"show"},"fast");break;case"PAYUWALLET-Payuw":jq("#liPayUMoney").animate({height:"show",opacity:"show"},"fast");break;}});jq("#cmbCardCat").bind("change",function(){if(jq(this).val()=="AMEX"){jq("#oPinCont").animate({height:"show",opacity:"show"},"fast");}else{jq("#oPinCont").animate({height:"hide",opacity:"hide"},"fast");}});jq("#txtBnkCitiReward").bind("change",function(){if(jq(this).val()=="IMINTCARD"){jq("#liCashCard").hide();jq("#liCityRewards").hide();jq("#liImint").animate({height:"show",opacity:"show"},"fast");}else{if(jq(this).val()=="CIT-DIRECT"){jq("#liCashCard").hide();jq("#liCityRewards").animate({height:"show",opacity:"show"},"fast");jq("#liImint").hide();}else{jq("#liCityRewards").hide();jq("#liImint").hide();jq("#liCashCard").animate({height:"show",opacity:"show"},"fast");}}});jq("#chkOffers").removeAttr("checked");jq("#chkOffers").bind("change",function(){if(jq(this).is(":checked")){jq("#offCont span[data-role='arrow']").removeClass("caret-u-g").addClass("caret-d-g");jq("#dOffersSec").animate({height:"show",opacity:"show"},"fast");}else{jq("#offCont span[data-role='arrow']").removeClass("caret-d-g").addClass("caret-u-g");jq("#dOffersSec").animate({height:"hide",opacity:"hide"},"fast");}});jq("#cmbDiscOff").bind("change",function(){jq("#dOfferNotes > .offNote").hide();jq("#errDivOf").hide();if(jq(this).val()==""){jq("#dOfferNotes > .offNote").hide();jq("#dOffCodeSec").animate({height:"hide",opacity:"hide"},"fast");jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");jq("#txtOffCode").val("");jq("#txtWPMMCode").val("");jq("#txtOffCode").show();jq("#txtWPMMCode").show();}else{if(jq(this).val()=="WP"){jq("#dOffCodeSec").animate({height:"show",opacity:"show"},"fast");jq("#txtOffCode").hide();jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");jq("#WP").animate({height:"show",opacity:"show"},"fast");jq("#txtWPMMCode").show();}else{if(jq(this).val()=="MM"){jq("#dOffCodeSec").animate({height:"show",opacity:"show"},"fast");jq("#txtOffCode").hide();jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");jq("#MM").animate({height:"show",opacity:"show"},"fast");jq("#txtWPMMCode").show();}else{if(jq(this).val()=="VODAFN0312"){jq("#dOffCodeSec").animate({height:"show",opacity:"show"},"fast");jq("#txtOffCode").hide();jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");jq("#VODAFN0312").animate({height:"show",opacity:"show"},"fast");jq("#txtWPMMCode").show();}else{if(jq(this).val()=="VODAAP0214"){jq("#dOffCodeSec").animate({height:"show",opacity:"show"},"fast");jq("#txtOffCode").hide();jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");jq("#VODAAP0214").animate({height:"show",opacity:"show"},"fast");jq("#txtWPMMCode").show();}else{if(jq(this).val()=="IDEA1113"){jq("#dOffCodeSec").animate({height:"show",opacity:"show"},"fast");jq("#txtOffCode").hide();jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");jq("#IDEA1113").animate({height:"show",opacity:"show"},"fast");jq("#txtWPMMCode").hide();}else{if(jq(this).val()=="OFF"){jq("#dOffCodeSec").animate({height:"hide",opacity:"hide"},"fast");jq("#dOffers").animate({height:"show",opacity:"show"},"fast");jq("#txtWPMMCode").val("");jq("#txtOffCode").show();jq("#txtWPMMCode").show();jq("#cmbOffer").val("");}else{if(jq(this).val()=="DTCN0612"){jq("#dOffCodeSec").animate({height:"show",opacity:"show"},"fast");jq("#txtOffCode").val("");jq("#txtOffCode").show();jq("#txtWPMMCode").val("");jq("#txtWPMMCode").show();jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");jq("#DTCN0612").animate({height:"show",opacity:"show"},"fast");}else{if(jq(this).val()=="dtlogin"){jq("#dOffCodeSec").animate({height:"hide",opacity:"hide"},"fast");fnReqLogin({from:"dtlogin"});}else{jq("#dOfferNotes > .offNote").hide();jq("#txtOffCode").val("");jq("#txtOffCode").show();jq("#dOffCodeSec").animate({height:"show",opacity:"show"},"fast");jq("#txtOffCode").focus();jq("#txtWPMMCode").show();jq("#txtWPMMCode").val("");jq("#dOffers").animate({height:"hide",opacity:"hide"},"fast");}}}}}}}}}});jq("#cmbOffer").bind("change",function(){jq("#dOfferNotes > .offNote").hide();jq("#"+jq(this).val()).animate({height:"show",opacity:"show"},"fast");});jq("#chkLoyPoints").removeAttr("checked");jq("#chkLoyPoints").bind("change",function(){if(jq(this).is(":checked")){jq("#dLotPts span[data-role='arrow']").removeClass("caret-u-g").addClass("caret-d-g");jq("#dPoints").animate({height:"show",opacity:"show"},"fast");}else{jq("#dLotPts span[data-role='arrow']").removeClass("caret-d-g").addClass("caret-u-g");jq("#dPoints").animate({height:"hide",opacity:"hide"},"fast");}});jq("#cmbRP").bind("change",function(){if(jq(this).val()=="imint"){jq("#imintcant").animate({height:"show",opacity:"show"},"fast");jq("#noteImint").animate({height:"show",opacity:"show"},"fast");}else{jq("#imintcant").animate({height:"hide",opacity:"hide"},"fast");jq("#noteImint").animate({height:"hide",opacity:"hide"},"fast");}});jq("#chkSaveDCAsk").removeAttr("checked");jq("#chkSaveDCAsk_EMI").removeAttr("checked");jq("#chkSaveNBAsk").removeAttr("checked");jq("#chkSaveNBAsk").bind("change",function(){if(jq(this).is(":checked")){jq("#dSaveNBDet").animate({height:"show",opacity:"show"},"fast");}else{jq("#dSaveNBDet").animate({height:"hide",opacity:"hide"},"fast");}});jq("#txtCardNo").bind("keyup",fnSetCard);jq("#txtCardNo").bind("blur",fnSetCard);jq("#txtCardNo_EMI").bind("keyup",fnSetCard_EMI);jq("#dWhatCards").hover(function(b){switch(b.type){case"mouseenter":jq("#dWhatCardsTooltip").css({top:jq(this).position().top-18+jq("#dWhatCards").height(),left:jq(this).position().left+253});jq("#dWhatCardsTooltip").fadeIn("fast");break;case"mouseleave":jq("#dWhatCardsTooltip").fadeOut("fast");break;}});fnBusy(true);fnGetBookingInfo();fnLoadNetBanks();fnSwitchLogin(objCk.get({name:"ld",key:"MEMBEREMAIL"})!="");if(objCk.get({name:"ld",key:"MEMBEREMAIL"})!=""){if(objCk.get({name:"ld",key:"EMAILSUBSCRIPTION"})=="Y"){jq("#chkReg").attr("checked",true);jq("#dChkAutoReg").hide();}if(jq("#txtMobile").val()!=""&&fnVal.mob(jq("#txtMobile").val())){jq("#dChkIntMob").hide();}if(jq("#dSecQuikPay").attr("data-mode")=="hide"){jq("#dSecQuikPay").show();fnDoSwitchAcc("dSecQuikPay");}}else{if(jq("#dSecPayOpts").attr("data-mode")=="hide"){fnDoSwitchAcc("dSecPayOpts");}jq("#spnMorePayOptsTag").html("Payment Options");jq("#dTMyPay a").html("QuikPays");}jq("#txtMobPrefix").css("color",(jq("#txtMobile").val()==""?"#B8B8B8":"black"));fnValidateSwapUserDetails(true);if(objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"){jq("#fConTransShare").show();}if(jq.trim(objCk.get({name:"strRef"}))!=""&&jq.trim(objCk.get({name:"strRef"}))!="CINEMA"){jq("#cmbDiscOff > option[value!=''][value!='WP']").remove();}if(SVC.substring(0,2).toUpperCase()=="DT"){jq("#chkOffers").attr("checked","checked").trigger("change");jq("#cmbDiscOff").val("DTCN0612").trigger("change");}else{jq("#cmbDiscOff option[value='DTCN0612']").remove();}}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnValidateSwapUserDetails(i){try{var k=jq("#txtCustName");var f=jq("#txtEmail");var d=jq("#txtMobile");var g=jq("#chkIntMob");var j=jq("#txtMobPrefix");var b=true;var c=true;var a=true;if(blnAcceptName){if(jq.trim(k.val())==""||jq.trim(k.val())==k.attr("placeholder")){b=false;}else{if(fnVal.chkName(jq.trim(k.val()))==false){b=false;}}}if(jq.trim(f.val())==""||jq.trim(f.val())=="Email address"){c=false;}else{if(!fnVal.email(f.val())){c=false;}}if(jq.trim(d.val())==""||jq.trim(d.val())=="Mobile number"){a=false;}else{if(g.is(":checked")==true&&/^[0-9]\d{9,}$/.test(jq.trim(d.val()))==false){a=false;}else{if(g.is(":checked")==false&&fnVal.mob(jq.trim(d.val()))==false){a=false;}}}if(b&&c&&a){jq("#dSecContactDet [data-role='email']").html(f.val());jq("#dSecContactDet [data-role='mobile']").html(j.val()+" "+d.val());if(i&&i==true){if(jq("#dSecContactDet").attr("data-mode")=="show"){fnDoSwitchAcc("dSecContactDet");}}}return b&&c&&a;}catch(h){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:h});}}function fnReqLogin(b){try{SignIn.fnSignIn(true);if(jq("#dSIMsg").length==0){jq("#errDivFSI").after('<div class="clear">&nbsp;</div><div class="error caerr" id="dSIMsg"><div class="erricon ic-warn"></div><div class="errtxt">You are required to sign in to use this feature. Please take a moment and log in.</div></div>');}jq("#dSignIn").show();(global.SignInCallBack=global.SignInCallBack||[]).push(function(){fnSwitchLogin(true);if(b){switch(b.from){case"mypay":jq("#dTMyPay").click();break;case"cdsave":jq("#chkSaveDCAsk").attr("checked","checked");jq("#chkSaveDCAsk").trigger("change");jq("#chkSaveDCAsk_EMI").attr("checked","checked");jq("#chkSaveDCAsk_EMI").trigger("change");break;case"nbsave":jq("#chkSaveNBAsk").attr("checked","checked");jq("#chkSaveNBAsk").trigger("change");break;case"offers":jq("#chkOffers").click();break;case"applyOffer":fnApplyOffer();break;case"dtlogin":jq("#cmbDiscOff").html('<option value="">Select Offer</option><option value="OFF">Offers</option><option value="WP">WinPin</option><option value="MM">Movie Money</option><option value="DTCN0612">DT Cinemas - DLF Employees offer</option><option value="VODAFN0312">Vodafone Delight</option><option value="VODAAP0214">Vodafone Tuesdays Offer</option><option value="IDEA1113">Idea Matinee Offer</option>');break;case"loyalty":jq("#chkLoyPoints").click();break;}}});}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnSwitchLogin(a){try{if(a==true){jq("#dSignedNote").show();jq("#dUnsignedNote").hide();jq("#dDCSaveDet").show();jq("#dNBSaveDet").show();jq("#dDCGuestSave").hide();jq("#dNBGuestSave").hide();jq(".dOfferGr").hide();jq("#dTMyPay a").removeAttr("onclick");jq("#dTMyPay").bind("click",function(){fnSwPayTab("MyPayments");jq("#errDivMWLP,#errDivMW").html("").hide();});jq("#dTMyPay .brgrDiv").hide();if(jq("#txtEmail").val()==""){jq("#txtEmail").val(objCk.get({name:"ld",key:"MEMBEREMAIL"}));}if(jq("#txtMobile").val()==""){jq("#txtMobile").val(objCk.get({name:"ld",key:"MOBILE"}));jq("#txtMobile").trigger("keyup");}if(jq("#txtMobiKwikEmail").val()==""){jq("#txtMobiKwikEmail").val(objCk.get({name:"ld",key:"MEMBEREMAIL"}));}if(jq("#txtMobiKwikMobile").val()==""){jq("#txtMobiKwikMobile").val(objCk.get({name:"ld",key:"MOBILE"}));}jq("#dChkAutoReg").show();if(objCk.get({name:"ld",key:"EMAILSUBSCRIPTION"})=="Y"){jq("#chkReg").attr("checked",true);jq("#dChkAutoReg").hide();}jq("#fConTransShare").hide();if(objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"){jq("#fConTransShare").show();}jq("#txtCheckPaybackNo").val(objCk.get({name:"ld",key:"MOBILE"}));jq("#chkSaveDCAsk").attr("checked",true);jq("#chkSaveDCAsk_EMI").attr("checked",true);jq("#chkSaveNBAsk").attr("checked",true);jq("#chkSaveDCAsk").trigger("change");jq("#chkSaveDCAsk_EMI").trigger("change");}else{jq("#dSignedNote").hide();jq("#dUnsignedNote").show();jq("#dDCSaveDet").hide();jq("#dNBSaveDet").hide();jq("#dDCGuestSave").show();jq("#dNBGuestSave").show();jq("#dTMyPay .brgrDiv").show();jq("#dTMyPay").unbind("click");jq(".dOfferGr").show();jq("#chkSaveDCAsk").removeAttr("checked");jq("#chkSaveDCAsk_EMI").removeAttr("checked");jq("#chkSaveNBAsk").removeAttr("checked");jq("#chkSaveDCAsk").trigger("change");jq("#chkSaveDCAsk_EMI").trigger("change");}}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}function fnGetBookingInfo(){try{if(TID==0){fnEsc();}else{fnWsData({AppC:AppC,venCode:SVC,transId:TID,cmd:"GETBOOKINGINFOEX",eventType:ETY,evtCode:"",sessId:SSID,data:escape("|TRANSID="+TID+"|"),fnCC:fnDispOS,fnEC:fnCanTr});}}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnDispOS(J){try{jq.globalEval(unescape(J));if(arrSumm==undefined||arrSumm[0]==undefined){fnEsc();}if(arrSO&&arrSO[0]&&arrSO[0][0]){var B=jq.inArray(arrSO[0][0]+"-"+arrSO[0][1],["IKPB-10003","IAPP-10002","CINM-10003","CMAW-10001","CADA-10002","CBNH-10001","PPCP-10001","PGMM-10001","PFMB-10001","PASC-10001","ICSK-10003"])!=-1;if(jq.trim(location.pathname.toLowerCase())!="/payment_icici/"&&B==true){fnGoTo("http://"+location.host+"/payment_icici/?cid="+arrSO[0][0]+"&sid="+arrSO[0][1]+"&ety="+arrSumm[0][5]);}}var F=arrSumm[0][42]+" ";if(arrSumm[0][4]!=""){AppC=arrSumm[0][4];}var s=0;var h=0;var n=0;var f=0;var w=0;var H=0;var K=0;var c=0;var z=0;var u=(arrSO&&arrSO[0]&&arrSO[0][15]?arrSO[0][15]:"");var q=false;for(var R=0;R<arrInv.length;R++){switch(arrInv[R][28]){case"FD":s+=parseFloat(arrInv[R][29]);h+=parseInt(arrInv[R][4],10);break;case"PR":n+=parseFloat(arrInv[R][29]);break;case"DN":f+=parseFloat(arrInv[R][29]);break;case"PK":c+=parseFloat(arrInv[R][29]);break;case"GV":K+=(parseFloat(arrInv[R][5])*parseInt(arrInv[R][4],10));break;case"RG":q=true;z+=parseFloat(arrInv[R][29]);break;default:w+=parseFloat(arrInv[R][29]);H+=parseInt(arrInv[R][4],10);break;}}var p=parseFloat(arrSumm[0][9]).toFixed(2);var D=parseFloat(arrSumm[0][29]).toFixed(0);var x=parseFloat(arrSumm[0][12]).toFixed(2);var r=parseFloat(arrSumm[0][45]).toFixed(2);s=parseFloat(s).toFixed(2);f=parseFloat(f).toFixed(2);w=parseFloat(w).toFixed(2);totGrand=parseFloat(arrSumm[0][16]).toFixed(2);lngGrandTotal=totGrand;if(AppC=="WEBGV"){totGrand=parseInt(K,10).toFixed(2);}z=parseFloat(z).toFixed(2);var t=parseFloat(arrSumm[0][45]).toFixed(2);var d=parseFloat(arrSumm[0][15]).toFixed(2);var v=arrSumm[0][41];var I=parseFloat(arrSumm[0][10]).toFixed(2);var A=parseFloat(arrSumm[0][13]).toFixed(2);if(q){I=parseFloat(arrSumm[0][13]).toFixed(2);}var O=parseFloat(parseFloat(p)+parseFloat(t)+parseFloat(I)-parseFloat(d)).toFixed(2);var M=jq("#noteTerms ol");var k="Your order will be delivered to you in 4-5 working days.";if(AppC=="WEBGV"){k="Your order will be delivered to you in the next 8 hours.";}if(p==0&&x!=0&&x!=1){M.html("<li>"+k+"</li>");}else{if(p!=0&&x!=0&&x!=1){M.append("<li>"+k+"</li>");}}objCk.set({name:"userCine",key:"RP",value:arrSumm[0][48]});if(objCk.get({name:"userCine",key:"RPT"})!=TID){objCk.set({name:"userCine",key:"SVC",value:SVC});objCk.set({name:"userCine",key:"SSID",value:SSID});objCk.set({name:"userCine",key:"ety",value:ETY});objCk.set({name:"userCine",key:"RPC",value:"0"});objCk.set({name:"userCine",key:"RPT",value:TID});}if(parseInt(objCk.get({name:"userCine",key:"RPC"}),10)>0&&arrSumm[0][41].length!=0){jq("#descOffer").html(arrSumm[0][41]).show();}if(arrSumm[0][48]=="Y"&&objCk.get({name:"userCine",key:"RPT"})==TID){if(arrSumm[0][31]!=""){jq("#txtEmail").val(arrSumm[0][31]).attr("disabled",true);}if(arrSumm[0][30]!=""){jq("#txtMobile").val(arrSumm[0][30]).attr("disabled",true);}}var m="";if(parseInt(D,10)!=0){m+='<div id="dTickets" class="rptr">';m+='<h2 class="odhead">Ticket Summary</h2>';for(var R=0;R<arrSO.length;R++){m+='<div class="sec-rptr nobod">';m+='<div class="hdr">';m+='<div class="fl_100">';m+="<div><span>Event:</span><p>"+arrSO[R][4]+"</p></div>";m+="</div>";if(arrSO.length>1){m+='<div class="fl_100">';m+='<div><span>&nbsp;</span><a href="javascript:;" class="moreless2">...Show More</a></div>';m+="</div>";}m+="</div>";m+='<div class="mnbdy">';m+='<div class="sec">';m+="<div><span>Venue: </span><p>"+arrSO[R][2]+"</p></div>";m+="<div><span>Location: </span><p>"+arrSO[R][3]+"</p></div>";if(isETicket=="Y"){m+="<div><span>Type: </span><p>E-Ticket</p></div>";}m+="<div><span>Date: </span><p>"+arrSO[R][7]+"</p></div>";m+="<div><span>Time: </span><p>"+arrSO[R][8]+"</p></div>";m+="<div><span>Seat Info: </span><p>"+arrSO[R][9]+"</p></div>";m+="<div><span>Qty: </span><p>"+(parseInt(arrSO[R][12],10)<D?parseInt(arrSO[R][12],10):D)+"</p></div>";m+="</div>";m+="</div>";m+="</div>";if(SVC=="IABW"||SVC=="WGMG"||SVC=="TSCD"){break;}}m+='<div class="btmtotal">';m+='<div class="ptotaln">';if(jq.inArray(SVC,arrNoPriceVenues)!=-1){m+="Total &amp; Other Charges (incl. Service Tax)";}else{if(parseInt(D,10)!=0){m+='<span>Total :</span> <span id="spnTicketAmt">'+F+p+"</span>";}}m+="</div>";if(parseInt(I,10)!=0){m+=' + (Internet handling fees : <span id="spnConv">'+F+I+"</span> (incl. of Service Tax))";}m+="</div>";m+="</div>";}var C="";var i="";var G="";var l="";var E="";var L="";var j="";var o="";if(AppC=="WEBGV"){for(var P=0;P<arrInv.length;P++){if(arrInv[P][28]=="GV"){var g=jq(jq.parseXML(arrInv[P][19])).find("Receivers > Receiver");for(var R=0;R<g.length;R++){var y=jq(g[R]);o+='<div class="sec">';o+="<div><span>Name: </span><p>"+y.find("Name").text()+"</p></div>";o+="<div><span>Email: </span><p>"+y.find("Email").text()+"</p></div>";o+="<div><span>Type: </span><p>"+arrInv[P][24]+"</p></div>";o+="<div><span>Quantity: </span><p>"+y.find("Quantity").text()+"</p></div>";o+="</div>";}}}}for(var R=0;R<arrInv.length;R++){switch(arrInv[R][28]){case"FD":C+='<div class="sec-rptr">';C+='<div class="hdr">';C+='<div class="fl_100">';C+="<div><span>Name:</span>";C+="<p>";if(SVC=="ADIP"){C+=arrInv[R][26];}else{C+=arrInv[R][24];}C+="</p>";C+="</div>";C+="</div>";C+='<div class="fl_100">';C+='<div><span>&nbsp;</span><a href="javascript:;" class="moreless2">...Show More</a></div>';C+="</div>";C+="</div>";C+='<div class="mnbdy">';C+='<div class="sec">';if(jq.trim(arrInv[R][25])!=""&&jq.trim(arrInv[R][24])!=jq.trim(arrInv[R][25])){C+="<div><span>Description: </span><p>"+arrInv[R][25]+"</p></div>";}C+="<div><span>Qty: </span><p>"+arrInv[R][4]+"</p></div>";C+="<div><span>Amount: </span><p>"+F+parseFloat(arrInv[R][29]).toFixed(2)+"</p></div>";C+="</div>";C+="</div>";C+="</div>";break;case"DN":i+='<div class="sec" style="border-bottom: none;">'+arrInv[R][24]+" donation has been added to your transaction.</div>";break;case"PR":l+='<div class="sec-rptr">';l+='<div class="hdr">';l+='<div class="fl_100">';l+="<div><span>Name:</span>";l+="<p>"+arrInv[R][24]+"</p>";l+="</div>";l+="</div>";if(arrInv.length>1){l+='<div class="fl_100">';l+='<div><span>&nbsp;</span><a href="javascript:;" class="moreless2">...Show More</a></div>';l+="</div>";}l+="</div>";l+='<div class="mnbdy">';l+='<div class="sec">';if(jq.trim(arrInv[R][25])!=""&&jq.trim(arrInv[R][24])!=jq.trim(arrInv[R][25])){l+="<div><span>Desc: </span><p>"+arrInv[R][25]+"</p></div>";}l+="<div><span>Qty: </span><p>"+arrInv[R][4]+"</p></div>";l+="<div><span>Amount: </span><p>"+F+parseFloat(arrInv[R][29]).toFixed(2)+"</p></div>";l+="</div>";l+="</div>";l+="</div>";break;case"GV":E='<div style="font-weight: bold;">Sender</div>';E+='<div class="sec">';E+="<div><span>Name: </span><p>"+jq("#txtGCName").val()+"</p></div>";E+="<div><span>Email: </span><p>"+jq("#txtGCEmail").val()+"</p></div>";E+="</div>";E+='<div style="font-weight: bold;">Receiver</div>';E+=o;break;case"RG":L+='<div class="sec-rptr">';L+='<div class="hdr">';L+='<div class="fl_100">';L+="<div><span>Name:</span>";L+="<p>"+arrInv[R][24]+"</p>";L+="</div>";L+="</div>";if(arrInv.length>1){L+='<div class="fl_100">';L+='<div><span>&nbsp;</span><a href="javascript:;" class="moreless2">...Show More</a></div>';L+="</div>";}L+="</div>";L+='<div class="mnbdy">';L+='<div class="sec">';if(jq.trim(arrInv[R][25])!=""&&jq.trim(arrInv[R][24])!=jq.trim(arrInv[R][25])){L+="<div><span>Desc: </span><p>"+arrInv[R][25]+"</p></div>";}L+="<div><span>Qty: </span><p>"+arrInv[R][4]+"</p></div>";L+="<div><span>Amount: </span><p>"+F+parseFloat(arrInv[R][29]).toFixed(2)+"</p></div>";L+="</div>";L+="</div>";L+="</div>";break;case"PK":j+='<div class="sec-rptr">';j+='<div class="hdr">';j+='<div class="fl_100">';j+="<div><span>Name:</span>";j+="<p>"+arrInv[R][24]+"</p>";j+="</div>";j+="</div>";if(arrInv.length>1){j+='<div class="fl_100">';j+='<div><span>&nbsp;</span><a href="javascript:;" class="moreless2">...Show More</a></div>';j+="</div>";}j+="</div>";j+='<div class="mnbdy">';j+='<div class="sec">';if(jq.trim(arrInv[R][25])!=""&&jq.trim(arrInv[R][24])!=jq.trim(arrInv[R][25])){j+="<div><span>Desc: </span><p>"+arrInv[R][25]+"</p></div>";}j+="<div><span>Qty: </span><p>"+arrInv[R][4]+"</p></div>";j+="<div><span>Amount: </span><p>"+F+parseFloat(arrInv[R][29]).toFixed(2)+"</p></div>";j+="</div>";j+="</div>";j+="</div>";break;default:G+='<div class="sec-rptr" style="border-top: 0px!important;">';G+='<div class="hdr">';G+='<div class="fl_100">';G+="<div><span>Name:</span>";G+="<p>"+arrInv[R][24]+"</p>";G+="</div>";G+="</div>";if(arrInv.length>1){G+='<div class="fl_100">';G+='<div><span>&nbsp;</span><a href="javascript:;" class="moreless2">...Show More</a></div>';G+="</div>";}G+="</div>";G+='<div class="mnbdy">';G+='<div class="sec">';if(jq.trim(arrInv[R][25])!=""&&jq.trim(arrInv[R][24])!=jq.trim(arrInv[R][25])){G+="<div><span>Desc: </span><p>"+arrInv[R][25]+"</p></div>";}G+="<div><span>Qty: </span><p>"+arrInv[R][4]+"</p></div>";G+="<div><span>Amount: </span><p>"+F+parseFloat(arrInv[R][29]).toFixed(2)+"</p></div>";G+="</div>";G+="</div>";G+="</div>";break;}}var Q="";for(var R=0;R<arrAddChgs.length;R++){Q+='<div class="sec">';Q+="<div><span>"+arrAddChgs[R][1]+": </span><p>"+arrAddChgs[R][0]+"</p></div>";Q+="</div>";}if(h!=0){m+='<div id="dFoodCombo" class="rptr">';m+='<h2 class="odhead">Add-ons</h2>';m+=C;m+="</div>";}if(parseInt(n,10)!=0){m+='<div id="dParking" class="rptr">';m+='<h2 class="odhead">Parking</h2>';m+=l;m+="</div>";}if(parseInt(f,10)!=0){m+='<div id="dDonation" class="rptr">';m+='<h2 class="odhead">Donation</h2>';m+=i;m+="</div>";}if(parseInt(K,10)!=0){m+='<div id="dGiftCard" class="rptr">';m+='<h2 class="odhead">Gift Card</h2>';m+=E;m+="</div>";}if(H!=0){m+='<div id="dMerch" class="rptr fl_100 mt5">';m+='<h2 class="odhead">Merchandise</h2>';m+=G;m+="</div>";}if(parseInt(z,10)!=0){m+='<div id="dReg" class="rptr">';m+='<h2 class="odhead">Registration</h2>';m+=L;m+="</div>";}if(parseInt(c,10)!=0){m+='<div id="dPack" class="rptr">';m+='<h2 class="odhead">Add-ons</h2>';m+=j;m+="</div>";}if(arrInv.length>0){m+='<div class="btmtotal">';m+='<div class="ptotaln">';m+='<span>Total :</span> <span id="spnMerc">'+F+x+"</span>";m+="</div>";if(parseInt(A,10)!=0){m+=' + (Merchandise handling fees : <span id="spnConv">'+F+A+"</span>)";}m+="</div>";}if(parseInt(r,10)!=0){m+='<div id="dAddChrgs" class="rptr">';m+='<h2 class="odhead">Other Charges</h2>';m+=Q;m+="</div>";}if(parseInt(d,10)==0){m+='<div id="osDisc" class="btmtotal" style="display: none;"><span> - Discount : <span id="spnDisc">'+F+d+"</span></span></div>";}else{m+='<div class="btmtotal"><span id="osDisc"> - Discount : <span id="spnDisc">'+F+d+"</span></span></div>";}m+="</div>";jq("#dOrderSummary").html(m);jq(".dTotal").html(F+totGrand);if(parseInt(d,10)!=0&&v.length!=0){jq("#descOffer").html(v).show();jq("#offCont, #dOffersSec").hide();}if(arrSO.length==0&&arrInv.length>0){jq("#dOffersSec").hide();jq("#offCont").hide();}if(parseInt(totGrand,10)==0){jq("#dvUNormalPrcdBtn").hide();jq("#dvUPrcdBtn").show();jq("#dPaySection > div").not("#dvUPrcdBtn").hide();}jq("#dOrderSummary .sec-rptr .mnbdy").hide();jq("#dOrderSummary .sec-rptr").each(function(){var a=jq(this);if(a.find(".moreless2:visible").length==0){a.find(".mnbdy").show();}});jq("#dOrderSummary .sec-rptr .moreless2").unbind("click");jq("#dOrderSummary .sec-rptr .moreless2").bind("click",function(){var a=jq(this).parents(".hdr").siblings(".mnbdy");a.animate({height:"toggle",opacity:"toggle"},"fast",function(){if(a.is(":visible")){jq(this).siblings(".hdr").find(".moreless2").html("...Show Less");}else{jq(this).siblings(".hdr").find(".moreless2").html("...Show More");}});});if(arrSO.length!=0){if(arrSO[0][5]=="Enrique Iglesias"||jq.trim(arrSO[0][5])=="Enrique Iglesias Live In Concert"){jq("#dOffersSec").hide();}}jq("#chkIntMob").attr("checked",false).trigger("onchange");if(arrSumm&&arrSumm.length>0&&arrSumm[0][51]&&arrSumm[0][51]=="Y"){fnShowPayOpt("PayPal");jq(".dPayConts").css("height","350px");}if(arrSumm[0][52]=="Y"){fnShowPayOpt("DebitCreditCard_EMI");jq(".dPayConts").css("height","350px");}if(AppC=="WEBGV"){jq("#offCont, #dLotPts, #dNBGuestSave").hide();for(var R=0;R<oPayTabs.length;R++){if(oPayTabs[R].tabName!="MyPayments"&&oPayTabs[R].tabName!="NetBanking"&&oPayTabs[R].tabName!="DebitCreditCard"){jq("#"+oPayTabs[R].tabId+", #"+oPayTabs[R].divId).remove();}}fnShowPayOpts(["MyPayments","DebitCreditCard","NetBanking"]);}if((AppC=="WEBSP"||AppC=="WEBINV")&&SVC=="BUDD"){fnShowPayOpts(["MyPayments","DebitCreditCard","NetBanking","AmexEzeClick","CashCard","RedeemPoints","COD","QRpay"]);jq("#cmbDiscOff > option[value!=''][value!='WP']").remove();}if(typeof(ga)!=="undefined"){for(var R=0;R<arrSO.length;R++){ga("set",2,"Event-ID",arrSO[R][15],2);ga("set",1,"Cinema-ID",arrSO[R][0],2);ga("set",3,"Session-ID",arrSO[R][1],2);}ga("set",4,"Event-Type",arrSumm[0][5],2);}if(arrSO.length>0){fnPushEventDataToAnalytics(["WR","KM"],"Viewed payment",{ProductID:arrSO[0][15],"Event Type":arrSumm[0][5],"Event Name":arrSO[0][4],"Venue Name":arrSO[0][2],Quantity:arrSO[0][12],"Order Total":totGrand,Category:arrSO[0][10],"Logged in viewed payment":(objCk.get({name:"ld",key:"MEMBEREMAIL"})!=""?"Yes":"No")});}fnBusy(true);fnContinueTrans();}catch(N){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:N});}}function fnContinueTrans(){try{fnDoTrans({AppC:AppC,venCode:SVC,transId:TID,cmd:"CONTINUETRANS",blnSupp:true,fnCC:function(b){fnStartTimer();if(objCk.get({name:"ld",key:"MEMBEREMAIL"})!=""){fnListPayOpts();}else{fnBusy(false);fnSwitchLastPayOpt();}},ecObj:true,fnEC:function(b){contTransErrNo=b.intExceptionEx;if(jq.trim(b.strException)!=""){jq("#txtContTransErr").html(b.strException);}fnBusy(false);fnCover(true);fnDoFloat("#dContTransErr").fadeIn("fast");}});}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnContTransToHome(){try{if(typeof(ga)!=="undefined"){ga("send","pageview","cont-trans-to-home_"+SVC+"_"+contTransErrNo);}jq("#dContTransErr").hide();fnBusy(true);fnCanTr();}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnSwitchLastPayOpt(b){try{var f=objCk.get({name:"userCine",key:"PAYTAB"});var h=false;for(var c=0;c<oPayTabs.length;c++){if(oPayTabs[c].tabName==f){h=true;break;}}if((b!=undefined&&b==0)&&h==false){fnSwPayTab("DebitCreditCard");return;}if(AppC=="WEBGV"){fnSwPayTab("DebitCreditCard");}else{if(h&&f!=""&&f!="CashOnDelivery"){fnSwPayTab(f);var d=objCk.get({name:"userCine",key:"PAYBANK"});jq("#dNetBnksAll").val(d);jq("input[name=radBnk]").removeAttr("checked");jq("input[name=radBnk][value="+d+"]").attr("checked","checked");jq("#dNetBnksDrop").val(d);}else{if(objCk.get({name:"ld"})!=""){fnSwPayTab(oPayTabs[0].tabName);}else{fnSwPayTab(oPayTabs[1].tabName);}}}}catch(g){}}function fnCanTr(){try{fnBusy(true);fnDoTrans({AppC:AppC,venCode:SVC,transId:TID,cmd:"CANCELTRANS",p1:"webuser",fnCC:fnEsc,fnEC:fnEsc});}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnEsc(){try{objCk.del({name:"BOOKINGID",path:""});objCk.del({name:"BOOKINGID",path:"/"});objCk.del({name:"lngTransId",path:""});objCk.del({name:"lngTransId",path:"/"});objCk.del({name:"merc",path:""});objCk.del({name:"merc",path:"/"});objCk.del({name:"AppC",path:""});objCk.del({name:"AppC",path:"/"});fnGoTo("http://"+location.host+"/");}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnStartTimer(){try{if(maxTime>=0){fnDispTimer(maxTime);maxTime=maxTime-1;clearTimeout(fnStartTimer.objTimer);fnStartTimer.objTimer=setTimeout((maxTime>0?"fnStartTimer()":"fnStopTimer()"),1000);}}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnDispTimer(c){try{var a=parseInt((c/60),10);var b=c%60;if(a>0){b=(b<10?"0"+b:b);jq("#spnTime").html(a+":"+b);jq("#spnTag").html("mins");}else{jq("#spnTime").html(b);jq("#spnTag").html("secs");}}catch(d){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:d});}}function fnStopTimer(){try{jq("#dTimer").html('<a href="javascript:;" onClick="fnCanTr();">Transaction timed out!</a>');clearTimeout(fnStartTimer.objTimer);fnDisableSubmit("timeout");}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}var oNetBnks=[{bankCode:"ICI-NA",bankName:"ICICI NetBanking"},{bankCode:"YBK-NA",bankName:"Yes Bank NetBanking"},{bankCode:"HDF-NA",bankName:"HDFC Bank NetBanking"},{bankCode:"CIT-NA",bankName:"Citibank NetBanking"},{bankCode:"SBI-NA",bankName:"SBI NetBanking"},{bankCode:"SCB-NA",bankName:"Standard Chartered Bank"},{bankCode:"UTI-NA",bankName:"AXIS Bank NetBanking"},{bankCode:"162-NA",bankName:"Kotak NetBanking"},{bankCode:"IDB-NA",bankName:"IDBI Bank NetBanking"},{bankCode:"ALB-NA",bankName:"Allahabad Bank NetBanking"},{bankCode:"ADB-NA",bankName:"Andhra Bank"},{bankCode:"BBK-NA",bankName:"Bank of Bahrain and Kuwait NetBanking"},{bankCode:"BBC-NA",bankName:"Bank of Baroda Corporate NetBanking"},{bankCode:"BBR-NA",bankName:"Bank of Baroda Retail NetBanking"},{bankCode:"BOI-NA",bankName:"Bank of India NetBanking"},{bankCode:"BOM-NA",bankName:"Bank of Maharashtra NetBanking"},{bankCode:"CSB-NA",bankName:"Catholic Syrian Bank NetBanking"},{bankCode:"CBI-NA",bankName:"Central Bank of India"},{bankCode:"CUB-NA",bankName:"City Union Bank NetBanking"},{bankCode:"CRP-NA",bankName:"Corporation Bank"},{bankCode:"DBK-NA",bankName:"Deutsche Bank NetBanking"},{bankCode:"DCB-NA",bankName:"Development Credit Bank"},{bankCode:"DLB-NA",bankName:"Dhanlaxmi Bank NetBanking"},{bankCode:"FBK-NA",bankName:"Federal Bank NetBanking"},{bankCode:"IDS-NA",bankName:"Indusind Bank NetBanking"},{bankCode:"IOB-NA",bankName:"Indian Overseas Bank"},{bankCode:"ING-NA",bankName:"ING Vysya Bank NetBanking"},{bankCode:"JKB-NA",bankName:"Jammu and Kashmir NetBanking"},{bankCode:"KBL-NA",bankName:"Karnataka Bank NetBanking"},{bankCode:"KVB-NA",bankName:"Karur Vysya Bank NetBanking"},{bankCode:"LVR-NA",bankName:"Lakshmi Vilas Bank NetBanking"},{bankCode:"OBC-NA",bankName:"Oriental Bank of Commerce NetBanking"},{bankCode:"CPN-NA",bankName:"PNB Corporate NetBanking"},{bankCode:"PNB-NA",bankName:"PNB NetBanking"},{bankCode:"RSD-DIRECT",bankName:"Rajasthan State Co-operative Bank-Debit Card"},{bankCode:"SWB-NA",bankName:"Saraswat Bank NetBanking"},{bankCode:"SBJ-NA",bankName:"SB Bikaner and Jaipur NetBanking"},{bankCode:"SBH-NA",bankName:"SB Hyderabad NetBanking"},{bankCode:"SBM-NA",bankName:"SB Mysore NetBanking"},{bankCode:"SBT-NA",bankName:"SB Travancore NetBanking"},{bankCode:"SVC-NA",bankName:"Shamrao Vitthal Co-operative Bank"},{bankCode:"SIB-NA",bankName:"South Indian Bank NetBanking"},{bankCode:"SBP-NA",bankName:"State Bank of Patiala NetNanking"},{bankCode:"SYD-NA",bankName:"Syndicate Bank NetBanking"},{bankCode:"TNC-NA",bankName:"Tamil Nadu State Co-operative Bank NetBanking"},{bankCode:"UBI-NA",bankName:"Union Bank NetBanking"},{bankCode:"UNI-NA",bankName:"United Bank of India NetBanking"},{bankCode:"VJB-NA",bankName:"Vijaya Bank NetBanking"}];function fnLuhnCheck(c){try{if(isNaN(c)){return false;}c=c.replace(/\D/g,"");var a=c.length;var b=a&1;var d=0;for(var f=0;f<a;f++){var h=parseInt(c.charAt(f),10);if(!((f&1)^b)){h*=2;if(h>9){h-=9;}}d+=h;}return(d%10==0)?true:false;}catch(g){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:g});}}function fnGetCardType(k){try{var b="";var l=[{regEx:/^4[0-9]{12}(?:[0-9]{3})?$/ig,cardType:"VISA"},{regEx:/^5[1-5][0-9]{14}$/ig,cardType:"MASTERCARD"},{regEx:/^3[47][0-9]{13}$/ig,cardType:"AMEX"},{regEx:/^(5[06-8]|6\d)\d{14}(\d{2,3})?$/ig,cardType:"MAESTRO"}];if(fnLuhnCheck(k)){for(var j=0;j<l.length;j++){if(k.match(l[j].regEx)){b=l[j].cardType;break;}}}if(k.indexOf("50")==0||k.indexOf("60")==0||k.indexOf("65")==0){var g="508500-508999|606985-607384|607385-607484|607485-607984|608001-608100|608101-608200|608201-608300|608301-608350|608351-608500|652150-652849|652850-653049|653050-653149";var i=g.split("|");for(var d=0;d<i.length;d++){var c=parseInt(i[d].split("-")[0],10);var f=parseInt(i[d].split("-")[1],10);if((k.substr(0,6)>=c&&k.substr(0,6)<=f)&&fnLuhnCheck(k)&&k.length==16){b="RUPAY";break;}}}return b;}catch(h){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:h});}}function fnSetCard(){try{var b=jq("#txtCardNo").val();b=b.replace(/\D/g,"");var a=fnGetCardType(b);jq("#imgCardType").removeClass("visa mastercard maestro amex rupay");if(a==""){jq("#dInvalidCard").hide();}else{switch(a){case"VISA":jq("#cmbCardCat").val("VISA");jq("#imgCardType").addClass("visa");break;case"MASTERCARD":jq("#cmbCardCat").val("MASTERCARD");jq("#imgCardType").addClass("mastercard");break;case"AMEX":jq("#cmbCardCat").val("AMEX");jq("#imgCardType").addClass("amex");break;case"MAESTRO":jq("#cmbCardCat").val("MAESTRO");jq("#imgCardType").addClass("maestro");break;case"RUPAY":jq("#cmbCardCat").val("RUPAY");jq("#imgCardType").addClass("rupay");break;}}if(b.slice(0,1)==3){cardTypeLen=15;}else{if(b.slice(0,1)==4){cardTypeLen=16;}else{cardTypeLen=19;}}if(b.length==cardTypeLen){if(fnLuhnCheck(b)){jq("#dInvalidCard").hide();}else{fnCMsgDis("errDivDC","You have entered an invalid card number!","e");}}if(b.length>cardTypeLen){fnCMsgDis("errDivDC","You have entered an invalid card number!","e");}if(a!=""){jq("#errDivDC").hide();}jq("#imgCvv, #imgCvvAmex").hide();if(a=="AMEX"){jq("#oPinCont").show();jq("#imgCvvAmex").show();}else{jq("#oPinCont").hide();if(a!=""){jq("#imgCvv").show();}}if(a=="MAESTRO"){jq("#dOptionalExpiryDate").show();}else{jq("#dOptionalExpiryDate").hide();}}catch(c){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:c});}}function fnLoadNetBanks(i){try{if(!i){i=[];}var d=9;var c="";var h='<option value="">=== Other Banks ===</option>';var f='<option value="">=== Select Bank ===</option>';for(var b=0;b<oNetBnks.length;b++){if(jq.inArray(oNetBnks[b].bankCode,i)==-1){f+='<option value="'+oNetBnks[b].bankCode+'">'+oNetBnks[b].bankName+"</option>";if(b<d){c+='<label><div class="banklogo mb10" title="'+oNetBnks[b].bankName+'">';c+='<input type="radio" name="radBnk" value="'+oNetBnks[b].bankCode+'" class="radio" onclick="fnSetNetBank(this.value, \'rad\');" />';c+='<img src="/img/pay/netbanks/'+oNetBnks[b].bankCode+'.png" alt="'+oNetBnks[b].bankName+"\" onerror=\"jq(this).parent().append(jq('<div/>').attr('class', 'fleft').css({ width: '100px', height: '25px' }).html('"+oNetBnks[b].bankName+"')); jq(this).remove();\" />";c+="</div></label>";}else{h+='<option value="'+oNetBnks[b].bankCode+'">'+oNetBnks[b].bankName+"</option>";}}}jq("#dNetBnksImgs").html(c);jq("#dNetBnksDrop").html(h);jq("#dNetBnksAll").html(f);}catch(g){fnErr({fnName:"fnLoadNetBanks",fnParams:arguments,err:g});}}function fnSetNetBank(a,b){try{if(b=="mypay"||b=="lastquikpay"){}else{try{objCk.set({name:"userCine",key:"PAYBANK",value:a});}catch(c){}a=jq.trim(a.toUpperCase());b=jq.trim(b.toLowerCase());jq("#dNetBnksAll").val(a);switch(b){case"rad":jq("#dNetBnksDrop").val("");break;case"cmb":jq("#dNetBnksImgs input[type='radio']").attr("checked",false);break;}}if(jq("#cmbOffer").length!=0){switch(a){case"YBK-NA":jq("#chkOffers").attr("checked",true).trigger("change");jq("#cmbDiscOff").val("OFF").trigger("change");jq("#cmbOffer").val("YESNB0214");break;default:jq("#chkOffers").attr("checked",false).trigger("change");break;}}}catch(c){fnErr({fnName:"fnSetNetBank",fnParams:arguments,err:c});}}(function(a){a.fn.formatCardNumber=function(e){var b="";if(typeof(e)==="string"){if(e=="getCardNo"){return a(this).val().replace(/\D/g,"");}}else{if(typeof(e)==="object"){b=e.cardTypeClassElement;}}var d=[{type:"visa",pattern:/^4/,length:[13,14,15,16]},{type:"mastercard",pattern:/^5[1-5]/,length:[16]},{type:"maestro",pattern:/^(62|63|5018|5020|5038|6304|6759|676[1-3])/,length:[12,13,14,15,16,17,18,19]},{type:"amex",pattern:/^3[47]/,length:[15]},{type:"rupay",pattern:/^(508|606|607|608|652|653)/,length:[16]}];function c(f){f=(f+"").replace(/\D/g,"");for(var g=0;g<d.length;g++){if(d[g].pattern.test(f)){return d[g];}}}a(this).on("keypress",function(f){if(f.metaKey||f.ctrlKey){return true;}if(f.which===32){return false;}if(f.which===0){return true;}if(f.which<33){return true;}return !!/[\d\s]/.test(String.fromCharCode(f.which));});a(this).on("keyup",function(){if(a.trim(a(this).val())==""){a(b).removeClass("visa mastercard maestro amex rupay");}});a(this).on("keypress",function(j){var l=String.fromCharCode(j.which);if(!/^\d+$/.test(l)){return;}var i=a(this).val();var g=c(i+l);if(b!=""){a(b).removeClass("visa mastercard maestro amex rupay");if(g!=undefined){a(b).addClass(g.type);}}var h=(i.replace(/\D/g,"")+l).length;var k=(g?g.length[g.length.length-1]:16);if(h>=k){return;}var f=(g&&g.type==="amex"?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/);if(f.test(i)){j.preventDefault();a(this).val(i+" "+l);}else{if(f.test(i+l)){j.preventDefault();a(this).val(i+l+" ");}}});a(this).on("keypress",function(g){var f=a(this).val();if(g.meta){return;}if(g.which===8&&/\s\d?$/.test(f)){g.preventDefault();return a(this).val(f.replace(/\s\d?$/,""));}});};})(jQuery);function fnSetCard(){try{var b=jq("#txtCardNo").val();b=b.replace(/\D/g,"");var a=fnGetCardType(b);if(a==""){jq("#dInvalidCard").hide();}else{jq("#cmbCardCat").val(a);}if(b.slice(0,1)==3){cardTypeLen=15;}else{if(b.slice(0,1)==4){cardTypeLen=16;}else{cardTypeLen=19;}}if(b.length==cardTypeLen){if(fnLuhnCheck(b)){jq("#dInvalidCard").hide();}else{fnCMsgDis("errDivDC","You have entered an invalid card number!","e");}}if(b.length>cardTypeLen){fnCMsgDis("errDivDC","You have entered an invalid card number!","e");}if(a!=""){jq("#errDivDC").hide();}if(a=="AMEX"){jq("#oPinCont").show();}else{jq("#oPinCont").hide();}if(a=="MAESTRO"){jq("#dOptionalExpiryDate").show();}else{jq("#dOptionalExpiryDate").hide();}}catch(c){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:c});}}function fnSetCard_EMI(){try{var b=jq("#txtCardNo_EMI").val();b=b.replace(/\D/g,"");var a=fnGetCardType(b);if(a==""){jq("#dInvalidCard_EMI").hide();}else{jq("#cmbCardCat_EMI").val(a);}if(b.slice(0,1)==3){cardTypeLen=15;}else{if(b.slice(0,1)==4){cardTypeLen=16;}else{cardTypeLen=19;}}if(b.length==cardTypeLen){if(fnLuhnCheck(b)){jq("#dInvalidCard_EMI").hide();}else{fnCMsgDis("errDivDC_EMI","You have entered an invalid card number!","e");}}if(b.length>cardTypeLen){fnCMsgDis("errDivDC_EMI","You have entered an invalid card number!","e");}if(a!=""){jq("#errDivDC_EMI").hide();}if(a=="AMEX"){jq("#oPinCont_EMI").show();}else{jq("#oPinCont_EMI").hide();}if(a=="MAESTRO"){jq("#dOptionalExpiryDate_EMI").show();}else{jq("#dOptionalExpiryDate_EMI").hide();}fnGetEMIDetails();}catch(c){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:c});}}var oPayTabs=[{tabName:"MyPayments",tabId:"dTMyPay",divId:"dCMyPay",onClick:fnPayMyPayments},{tabName:"DebitCreditCard",tabId:"dTDCCrd",divId:"dCDCCrd",onClick:fnPayCard},{tabName:"AmexEzeClick",tabId:"dTAmexEze",divId:"dCAmexEze",onClick:fnPayAmexEzeClick},{tabName:"NetBanking",tabId:"dTNetBnk",divId:"dCNetBnk",onClick:fnPayNetBank},{tabName:"CashCard",tabId:"dTCshCrd",divId:"dCCshCrd",onClick:fnPayCashCards},{tabName:"PayPal",tabId:"dTPayPal",divId:"dCPayPal",onClick:fnPayPayPal},{tabName:"GiftVoucher",tabId:"dTGftVchr",divId:"dCGftVchr",onClick:fnPayGiftVoucher},{tabName:"RedeemPoints",tabId:"dTRdmPnts",divId:"dCRdmPnts",onClick:fnPayPoints},{tabName:"COD",tabId:"dTCOD",divId:"dCCOD",onClick:fnPayPoints},{tabName:"QRpay",tabId:"dTQRpay",divId:"dCQRpay",onClick:fnPayPoints},{tabName:"DebitCreditCard_EMI",tabId:"dTDCCrd_EMI",divId:"dCDCCrd_EMI",onClick:fnPayCard_EMI}];function fnDoSwitchAcc(g){try{var h=jq("#"+g);var c=h.find("[data-role='header']");var k=h.find("[data-role='arrow']");var p=h.find("[data-role='body']");if(p.hasClass("show")){c.addClass("pheadwh");k.addClass("caret-u-g").removeClass("caret-d");p.addClass("hide").removeClass("show");}else{c.removeClass("pheadwh");k.removeClass("caret-u-g").addClass("caret-d");p.addClass("show").removeClass("hide");}var m=(p.hasClass("show")?"show":"hide");if(g=="dSecContactDet"&&fnValidateSwapUserDetails()){var f=h.find("[data-role='email']");var n=h.find("[data-role='mobile']");var j=h.find("[data-role='change']");var c=h.find("[data-role='head']");var k=h.find("[data-role='arrow']");if(m=="show"){f.hide();n.hide();j.hide();c.show();k.show();}else{if(m=="hide"){f.show();n.show();j.show();c.hide();k.hide();}}}if(g=="dSecContactDet"){if(m=="show"){c.removeClass("pheadwh");k.removeClass("caret-u-g").addClass("caret-d-g");p.addClass("show").removeClass("hide");}else{if(m=="hide"){c.addClass("pheadwh");k.addClass("caret-u-g").removeClass("caret-d-g");p.addClass("hide").removeClass("show");}}}else{if(g=="dSecQuikPay"||g=="dSecPayOpts"){var i=(g=="dSecQuikPay"?"dSecPayOpts":"dSecQuikPay");var b=jq("#"+i);var a=b.find("[data-role='header']");var d=b.find("[data-role='arrow']");var o=b.find("[data-role='body']");if(m=="show"){a.addClass("pheadwh");d.addClass("caret-u-g").removeClass("caret-d");o.addClass("hide").removeClass("show");c.removeClass("pheadwh");k.removeClass("caret-u-g").addClass("caret-d");p.addClass("show").removeClass("hide");}else{if(m=="hide"){c.addClass("pheadwh");k.addClass("caret-u-g").removeClass("caret-d");p.addClass("hide").removeClass("show");a.removeClass("pheadwh");d.removeClass("caret-u-g").addClass("caret-d");o.addClass("show").removeClass("hide");}else{}}b.attr("data-mode",(o.hasClass("show")?"show":"hide"));if(g=="dSecQuikPay"&&m=="show"){if(h.attr("data-paytype")=="CD"){fnLoadOffers("DebitCreditCard");}else{if(h.attr("data-paytype")=="NB"){fnLoadOffers("NetBanking");}}}else{if(g=="dSecPayOpts"&&m=="show"){fnLoadOffers(strCurrentTab);}}}}h.attr("data-mode",(p.hasClass("show")?"show":"hide"));}catch(l){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:l});}}function fnSwapCvvSec(b){try{var c=jq("#txtCardNo").val().replace(/\D/g,"");var a=fnGetCardType(c);jq("#imgCvv").hide();jq("#imgCvvAmex").hide();if(a!=""&&b){if(a=="AMEX"){jq("#imgCvvAmex").show();}else{jq("#imgCvv").show();}}}catch(d){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:d});}}function fnShowPayOpt(c){try{for(var b=0;b<oPayTabs.length;b++){if(oPayTabs[b].tabName==c){jq("#"+oPayTabs[b].tabId).show();}}}catch(d){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:d});}}function fnShowPayOpts(f){try{var h=[];if(f=="ALL"){for(var b=0;b<oPayTabs.length;b++){if(oPayTabs[b].tabName=="PayPal"){if(arrSumm&&arrSumm.length>0&&arrSumm[0][51]&&arrSumm[0][51]=="Y"){fnShowPayOpt(oPayTabs[b].tabName);h.push(oPayTabs[b].tabName);}}else{fnShowPayOpt(oPayTabs[b].tabName);h.push(oPayTabs[b].tabName);}}}else{if(typeof(f)=="object"){for(var b=0;b<oPayTabs.length;b++){jq("#"+oPayTabs[b].tabId).hide();}for(var b=0;b<f.length;b++){fnShowPayOpt(f[b]);h.push(f[b]);}}else{for(var b=oPayTabs.length-1;b>=0;b--){jq("#"+oPayTabs[b].tabId).hide();jq("#"+oPayTabs[b].divId).hide();var d=Math.pow(2,b);var c=f/d;if(c>=1&&c<2){fnShowPayOpt(oPayTabs[b].tabName);h.push(oPayTabs[b].tabName);f-=d;}}}}if(objCk.get({name:"ld"})==""){fnSwPayTab(oPayTabs[1].tabName,false);}else{fnSwPayTab(h[0],false);}}catch(g){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:g});}}function fnSwBorderSize(){try{jq("#dPayTabsSec").animate({height:Math.max(jq("#dPayTabs").height(),jq("#dPayConts").height()+parseInt(jq("#dPayConts").css("margin-bottom"),10))},"fast");}catch(a){fnErr({fnName:"fnSwBorderSize",fnParams:arguments,err:a});}}var strCurrentTab="";function fnSwPayTab(f,c){try{strCurrentTab=f;jq("#dPayTabs ul li").each(function(a,e){jq(e).attr("class","normal");});jq("#dPayConts > div").hide();for(var b=0;b<oPayTabs.length;b++){if(oPayTabs[b].tabName==f){jq("#"+oPayTabs[b].tabId).attr("class","chosen");jq("#"+oPayTabs[b].divId).show();jq("#btnMakePayment").attr("data-onclick",oPayTabs[b].onClick.name+"();");jq("#btnMakePayment").unbind("click");jq("#btnMakePayment").bind("click",oPayTabs[b].onClick);jq("#btnMakePayment").bind("click",function(){if(typeof(ga)!=="undefined"){ga("send","pageview","payment-paynow");}});break;}}fnLoadOffers(f);jq("#osEMIProcessingFees").hide();jq(".dTotal").html(arrSumm[0][42]+" "+lngGrandTotal);if(f=="GiftVoucher"){jq("#dCheckMkPayBtn").hide();}else{if(f=="DebitCreditCard_EMI"){if(fnGetCardType(jq("#txtCardNo_EMI").val().replace(/\D/g,""))==""){if(jq("#dEMIDetails").is(":visible")){jq("#dCheckMkPayBtn").show();}else{jq("#dCheckMkPayBtn").hide();}jq("#osEMIProcessingFees").show();}else{if(jq("#dEMIDetails").is(":visible")){jq("#dCheckMkPayBtn").show();}else{jq("#dCheckMkPayBtn").hide();}}var d=jq("tr input[type='radio'][name='emi-option']:checked");if(d.length!=0){jq(".dTotal").html(arrSumm[0][42]+" "+d.attr("data-price"));}}else{jq("#dCheckMkPayBtn").show();}}if(maxTime==0){jq("#dCheckMkPayBtn").hide();}if(f=="PayPal"&&arrSumm!=undefined&&arrSumm[0][16]!=undefined){fnBusy(true);fnConvCurr(arrSumm[0][16]);}if(f=="MyPayments"){forceTabSwitch=true;if(typeof(CardDetails)=="undefined"){fnListPayOpts();}}if(c==undefined){c=true;}if(c){if(f!="CashOnDelivery"&&f!="MyPayments"&&f!="PayPal"){try{objCk.set({name:"userCine",key:"PAYTAB",value:f});}catch(g){}}}}catch(g){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:g});}}function fnConvCurr(b){try{fnAjax({url:global.ajHTML,data:{cmd:"CURRCONV",amt:b,from:"INR",to:"USD"},success:function(c){jq("#dPriceUSD").html(c);fnBusy(false);},error:function(c){fnErr({fnName:"fnConvCurr",fnParams:b,err:c});fnBusy(false);}});}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnPushEventDataToAnalytics(c,b,d){try{var g=jq.extend(true,{},d);var a=jq.extend(true,{},d);if(jq.inArray("WR",c)!=-1){if(typeof(wizrocket)!=="undefined"&&typeof(wizrocket.event)!=="undefined"){wizrocket.event.push(b,g);}}if(jq.inArray("KM",c)!=-1){if(typeof(_kmq)!=="undefined"){_kmq.push(["record",b,a]);}}}catch(f){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:f});}}function fnDisableSubmit(c,j){try{jq("#btnMakePayment").unbind("click");if(c==undefined||c==""){c="TIMEOUT";}c=jq.trim(c).toUpperCase();switch(c){case"PROCESSING":fnBusy(true);jq("#btnMakePayment").html("Processing").removeAttr("onclick");if(typeof(ga)!=="undefined"){ga("send","pageview","payment-form-submit");}if(objCk.get({name:"ld",key:"MEMBEREMAIL"})==""){objCk.set({name:"le",value:jq("#txtEmail").val()});}if(arrSO.length>0){var i="";if(objCk.get({name:"ld",key:"MEMBEREMAIL"})==""){i="Not logged in";}else{if(typeof(CardDetails)!=="undefined"&&CardDetails.length==0){i="Not available";}else{if(jq("#dListMyPay").is(":visible")){i="Used";}else{i="Not used";}}}var d=((jq("#dCNetBnk").is(":visible")&&jq("#chkSaveNBAsk").is(":checked"))||(jq("#dCDCCrd").is(":visible")&&jq("#chkSaveDCAsk").is(":checked")));fnPushEventDataToAnalytics(["WR","KM"],"Pay Now",{ProductID:arrSO[0][15],"Event Type":arrSumm[0][5],"Event Name":arrSO[0][4],"Quickpay action":i,"Added new QP":(d==true?"Yes":"No"),"Venue Name":arrSO[0][2],"Venue Code":arrSO[0][0],Quantity:arrSumm[0][29],Discount:jq("#spnDisc").html(),"Payment mode":(typeof(strCurrentTab)!=="undefined"?strCurrentTab:"")});}if(blnAcceptName){var h="";h+="<Details>";h+="<TicketBookingId>"+BID+"</TicketBookingId>";h+="</Details>";h=h.replace(/</g,"&lt;").replace(/>/g,"&gt;");var g="";g+="<FirstName>"+jq("#txtCustName").val()+"</FirstName>";g=g.replace(/</g,"&lt;").replace(/>/g,"&gt;");fnDoTrans({AppC:AppC,venCode:SVC,transId:TID,cmd:"UPDATEDELIVERYDETAILS",p1:h,p4:g,fnCC:function(a){fnBusy(true);setTimeout(j,200);},fnEC:function(a){fnBusy(false);}});}else{setTimeout(j,200);}break;case"TIMEOUT":jq("#lnkToDet").removeAttr("onclick");jq("#dTimedOut").show();jq("#dCheckMkPayBtn").hide();jq("#dTimedOutQuikPay").show();jq("#dCheckMkPayBtnQuikPay").hide();jq("#dTimer").html('<a href="javascript:;" onClick="fnCanTr();">Transaction timed out!</a>');clearTimeout(fnStartTimer.objTimer);objCk.del({name:"BOOKINGID"});objCk.del({name:"lngTransId"});if(typeof(ga)!=="undefined"){ga("send","pageview","payment-timed-out");}jq("#btnMakePayment").html("Transaction timed out").bind("click",fnCanTr);for(var b=0;b<oPayTabs.length;b++){oPayTabs[b].onClick=fnCanTr;}break;}}catch(f){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:f});}}function fnGetEMIDetails(){try{var c=jq("#txtCardNo_EMI").val().replace(/\D/g,"");var a=fnGetCardType(c);jq("#dExpiryDate_EMI, #dOptionalExpiryDate_EMI, #dCVV_EMI, #dCardName_EMI").hide();jq("#dEMIDetails").hide();jq("#osEMIProcessingFees").hide();jq("#dCheckMkPayBtn").hide();if(objCk.get({name:"ld"})==""){jq("#dDCGuestSave_EMI").hide();}else{jq("#dDCSaveDet_EMI").hide();}jq(".dTotal").html(arrSumm[0][42]+" "+parseFloat(arrSumm[0][16]).toFixed(2));if(a==""){jq("#dCheckMkPayBtn").hide();jq("#dEnterCardNo_EMI").show();fnBusy(false);}else{if(!jq("#dCover").is(":visible")){fnBusy(true);}jq("#dEnterCardNo_EMI").hide();fnWsPayData({strAppCode:"WEBIN",strCommand:"GETEMIDETAILS",strPayType:"PAYUEMI",blnSupp:true,strCardNo:c,lngTransId:TID,ccObj:true,fnCC:function(f){var e="Select a Plan:<br/>";e+='<table class="tbl-emi-details">';e+='<tr class="emihead">';e+="<th></th>";e+="<th>Tenure (months)</th>";e+="<th>Monthly Installments</th>";e+="<th>Total Payable Amount</th>";e+="</tr>";for(var d=0;d<f.data.length;d++){e+='<tr id="tr_'+f.data[d].EMIBankCode+'" class="emiopt">';e+='<td><input type="radio" name="emi-option" value="'+f.data[d].EMIBankCode+'" onclick="fnSelEMIOpt();" data-price="'+f.data[d].Price+'" data-processing-fees="'+f.data[d].ProcessingFees+'" /></td>';e+="<td>"+f.data[d].NoOfEMI+"</td>";e+="<td>"+arrSumm[0][42]+" "+f.data[d].EMIAmount+"</td>";e+="<td>"+arrSumm[0][42]+" "+f.data[d].TotalPayableAmount+"</td>";e+="</tr>";e+='<tr emi-det-id="det_'+f.data[d].EMIBankCode+'" class="det" style="display: none;">';e+='<td colspan="6">';e+="Over "+f.data[d].NoOfEMI+" months, you pay "+arrSumm[0][42]+" "+f.data[d].InterestAmount;e+=" ("+f.data[d].InterestRate+"%) as total interest to the bank on a billed amount of "+arrSumm[0][42]+" "+f.data[d].TotalPayableAmount+". ";if(parseInt(f.data[d].ProcessingFees,10)!=0){e+="A processing fee of "+arrSumm[0][42]+" "+f.data[d].ProcessingFees+" will be charged. ";}e+="The exact amount of bank interest will reflect on your bank statement.";e+="</td>";e+="</tr>";}e+="</table>";e+='<div class="fleft">Inclusive of all charges</div>';e+='<div class="fright"><a id="lnkEMIInfoCallout" href="javascript:;" onclick="fnSwEMICallout(true);">Know More &raquo;</a></div>';jq("#dEMIDetails").html(e).show();fnBusy(false);},fnEC:function(d){fnCMsgDis("errDivDC_EMI",d,"e");fnBusy(false);}});}}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}function fnSwEMICallout(a){try{if(a){fnCover(true);fnDoFloat("#dEMIInfoCallout").show();}else{fnCover(false);jq("#dEMIInfoCallout").hide();}}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}function fnSelEMIOpt(){try{var c=jq("tr input[type='radio'][name='emi-option']:checked");var b=jq("#txtCardNo_EMI").val().replace(/\D/g,"");var a=fnGetCardType(b);if(jq("#osEMIProcessingFees").length==0){jq("#osDisc").after('<span id="osEMIProcessingFees"> + EMI processing fees: '+arrSumm[0][42]+" "+parseFloat(c.data("processing-fees")).toFixed(2)+".</span>");}else{jq("#osEMIProcessingFees").html(" + EMI processing fees: "+arrSumm[0][42]+" "+parseFloat(c.data("processing-fees")).toFixed(2)+".");}if(c.data("processing-fees")==0){jq("#osEMIProcessingFees").hide();}jq(".dTotal").html(arrSumm[0][42]+" "+parseFloat(c.data("price")).toFixed(2));jq("#dExpiryDate_EMI, #dOptionalExpiryDate_EMI, #dCVV_EMI, #dCardName_EMI").show();jq("#imgCvv_EMI, #imgCvvAmex_EMI").hide();if(a=="AMEX"){jq("#oPinCont_EMI").show();jq("#imgCvvAmex_EMI").show();}else{jq("#oPinCont_EMI").hide();if(a!=""){jq("#imgCvv_EMI").show();}}if(a=="MAESTRO"){jq("#dOptionalExpiryDate_EMI").show();}else{jq("#dOptionalExpiryDate_EMI").hide();}jq("tr[emi-det-id]").hide();jq("#dEMIDetails tr[id*=tr_]").removeClass("emiopt-sel");jq("#dEMIDetails #tr_"+c.val()).addClass("emiopt-sel");jq("tr[emi-det-id=det_"+c.val()+"]").show();jq("#dCheckMkPayBtn").show();if(objCk.get({name:"ld"})==""){jq("#dDCGuestSave_EMI").show();}else{jq("#dDCSaveDet_EMI").show();}}catch(d){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:d});}}function fnWsPayData(d){try{var c=["fnCC","fnEC","blnSupp","ccObj","ecObj"];var h={};for(var k in d){if(jq.inArray(k,c)==-1){h[k]=d[k];}}var a=(d.ccObj!=undefined)?d.ccObj:false;var j=(d.ecObj!=undefined)?d.ecObj:false;var b=(d.fnCC!=undefined&&d.fnCC)?d.fnCC:false;var f=(d.fnEC!=undefined&&d.fnEC)?d.fnEC:false;var i=(d.blnSupp!=undefined)?d.blnSupp:false;var l=JSON.stringify(h);if(jq("#glErrDiv").is(":visible")){jq("#glErrDiv").hide();}fnAjax({data:h,dataType:"json",error:function(n,e,m){fnErr({fnName:"fnWsPayData",fnParams:d});},success:function(e){if(e.blnSuccess==true){if(b){if(a){b(e);}else{b(e.data);}}}else{if(!i){fnBusy(false);fnGlobalErr({eMess:e.strException,eCode:e.intExceptionEx,eCmd:l,eRFn:"function: fnWsPayData"});}if(f){if(j){f(e);}else{f(e.strException);}}}},type:"POST",url:"/secure/wsPayData.bms"});}catch(g){fnErr({fnName:"fnWsPayData",fnParams:d,err:g});}}function fnShwDErr(a){try{var b=jq(a).attr("id");if(!jq(a).next().is(":visible")){jq(a).next().slideDown(300);jq("#"+b).children(".ic-arrt").removeClass("ic-arrt").addClass("ic-ardn");}else{jq(a).next().slideUp(300);jq("#"+b).children(".ic-ardn").removeClass("ic-ardn").addClass("ic-arrt");}}catch(c){fnErr({fnName:"fnShwDErr",fnParams:a,err:c});}}function fnRData(){try{var a=new clsCookie();strRandom=a.get({name:"ld"});if(strRandom!=""){var c=fnGVal({key:"MEMBEREMAIL",data:strRandom});var b=((fnGVal({key:"NAME",data:strRandom})!="")?fnGVal({key:"NAME",data:strRandom}):fnGVal({key:"FIRSTNAME",data:strRandom})+fnGVal({key:"LASTNAME",data:strRandom}));jq("#iRepEmail").val(c);jq("#iRepName").val(b);}var f="<ul>";f+="<li><strong>Browser Information:</strong>"+navigator.userAgent+"</li>";f+="<li><strong>Operating System:</strong>"+navigator.oscpu+"<li>";f+="<li><strong>Page URL:</strong>"+decodeURIComponent(location.href)+"</li>";f+="<li><b>Note: This information will be sent</b></li>";f+="</ul> ";jq("#dAddData").removeClass("ic-ardn").addClass("ic-arrt");jq("#iRepBInfo").html(f).hide();fnCover(true);jq("#errDivRE").html("").hide();fnDoFloat("#report").fadeIn("fast");jq("#addInfo").bind("click",function(){jq("#iRepBInfo").slideToggle(300);if(!jq("#iRepBInfo").is(":visible")){jq("#addInfo").prev().removeClass("ic-arrt").addClass("ic-ardn");}else{jq("#addInfo").prev().removeClass("ic-ardn").addClass("ic-arrt");}});}catch(d){fnErr({fnName:"fnRData",err:d});}}function fnValReport(){try{var c=jq("#iREEmail").val();var b=jq("#iREName").val();var a=jq("#iREComment").val();var g=jq("#iRepBInfo").text();var d=g+"Technical Error:"+jq("#SEData").text()+" Command: "+jq("#iRECmdInfo").text();if(jq.trim(c)==""){fnCMsgDis("errDivRE","Email Id cannot be blank","e");jq("#txtEmail").focus();return false;}if(jq.trim(b)==""){fnCMsgDis("errDivRE","Name cannot be blank","e");jq("#txtName").focus();return false;}if(jq.trim(a)==""){fnCMsgDis("errDivRE","Comment cannot be blank","e");jq("#txtComment").focus();return false;}if(!fnVal.chkName(b)){fnCMsgDis("errDivRE","Name is not valid","e");jq("#txtName").focus();return false;}if(!fnVal.email(c)){fnCMsgDis("errDivRE","Email Id is not valid","e");jq("#txtEmail").focus();return false;}jq("#butRepSubmit").hide();jq("#repldng").show();fnAjax({data:"cmd=REPORT&un="+escape(b)+"&ue="+escape(c)+"&uc="+escape(a)+"&ea="+escape(d)+"&ui="+strUserIP,dataType:"text",success:function(h){h=unescape(h).split("~");var e="";if(h[0]=="1"){e="";}if(h[0]=="0"){e="e";jq("#repldng").hide();jq("#butRepSubmit").show();fnCMsgDis("errDivRE",h[1],e);return false;}(function(){jq("#repldng").hide();jq("#butRepSubmit").show();fnCMsgDis("errDivRE",h[1],e);setTimeout(function(){jq("#glErrDiv").slideUp("fast");jq("#report").fadeOut("fast");fnCover(false);},5500);})(jq);},url:"/insData.bms"});}catch(f){fnErr({fnName:"fnValReport",err:f});}}var oOffers=[];var arrAllTabsOffers=["DTCN0612","SHATAN0611","BEN101212","CNPL0113","GOPAL0112","VODAFN0312","VODAAP0214","IDEA1113","IMINTB2G1","PTCPTATA","IMINT50110"];function fnLoadOffers(f){try{if(oOffers.length==0){jq("#cmbOffer option").each(function(a,b){if(a==0){return;}oOffers.push({offerType:jq(b).data("offertype").split("|"),offerCode:jq(b).val(),offerName:jq(b).html(),offerBankCode:(jq(b).attr("data-bankcode")||"")});});}if(f==undefined){f="ALL";}if(f=="MyPayments"){jq("#cmbOffer option").remove();jq("#cmbOffer").append(jq("<option/>").val("").html("== Select Offer =="));for(var d=0;d<oOffers.length;d++){jq("#cmbOffer").append(jq("<option/>").val(oOffers[d].offerCode).html(oOffers[d].offerName).attr("data-offertype",oOffers[d].offerType.join("|")).attr("data-bankcode",oOffers[d].offerBankCode));}}else{var g=[];for(var d=0;d<oOffers.length;d++){for(var c=0;c<oOffers[d].offerType.length;c++){if(f==oOffers[d].offerType[c]){g.push(oOffers[d]);}}}if(g.length==0){jq("#cmbOffer option").remove();jq("#cmbOffer").append(jq("<option/>").val("").html("No offers available for this payment method"));}else{jq("#cmbOffer option").remove();jq("#cmbOffer").append(jq("<option/>").val("").html("== Select Offer =="));for(var d=0;d<g.length;d++){jq("#cmbOffer").append(jq("<option/>").val(g[d].offerCode).html(g[d].offerName).attr("data-offertype",g[d].offerType.join("|")).attr("data-bankcode",g[d].offerBankCode));}}}if(jq("#dSecQuikPay").is(":visible")&&jq("#dSecQuikPay").attr("data-paytype")=="NB"){if(jq("#cmbOffer option[data-bankcode='"+jq("#dSecQuikPay").attr("data-cardtype")+"']").length!=0){fnSetNetBank(jq("#dSecQuikPay").attr("data-cardtype"),"lastquikpay");}}}catch(h){fnErr({fnName:"fnLoadOffers",fnParams:arguments,err:h});}}function fnApplyOffer(){try{var l=(jq("#dCMyPay").is(":visible")?"MYPAY":"OTHER");var l="OTHER";if(jq("#dCMyPay").is(":visible")){l="MYPAY";}else{if(jq("#dSecQuikPay").attr("data-mode")=="show"){l="LASTQUIKPAY";}}var b=jq("#cmbDiscOff").val();var g;var k;var a;if(b==""){fnCMsgDis("errDivOf","Please select an offer type!","e");return;}else{if(b=="WP"||b=="MM"){g=b;k=jq("#txtWPMMCode");if(k.val()==""){if(b=="WP"){fnCMsgDis("errDivOf","Please enter a WinPin!","e");}else{if(b=="MM"){fnCMsgDis("errDivOf","Please enter a Movie Money Code!","e");}else{fnCMsgDis("errDivOf","Please enter an offercode!","e");}}k.focus();return;}else{if(isNaN(k.val())){if(b=="WP"){fnCMsgDis("errDivOf","Please enter a valid WinPin!","e");}else{if(b=="MM"){fnCMsgDis("errDivOf","Please enter a valid Movie Money Code!","e");}}k.focus();return;}}fnBusy(true);fnDoTrans({cmd:"SETPROMOTIONCODE",transId:TID,venCode:SVC,p1:k.val(),fnCC:function(t){var m=arrSumm[0][42]+" ";var n=m+fnGVal({data:t,key:"TICKETSAMT"});var r=m+fnGVal({data:t,key:"BOOKINGFEE"});var q=m+fnGVal({data:t,key:"DISCOUNTAMT"});var o=q.toString();var s=fnGVal({data:t,key:"TOTALAMT"});var e=m+s;var p=fnGVal({data:t,key:"DISCOUNTTEXT"});if(arrSO.length>0){fnPushEventDataToAnalytics(["WR","KM"],"Payment Offer",{ProductID:arrSO[0][15],"Event Type":arrSumm[0][5],"Event Name":arrSO[0][4],"Offer code":jq("#cmbDiscOff option:selected").html(),"Offer Name":jq("#cmbDiscOff option:selected").html(),"Offer status":"Granted","Offer value":fnGVal({data:t,key:"DISCOUNTAMT"}),"Failure reason":""});}if(jq("#dCPayPal").is(":visible")){fnBusy(true);fnConvCurr(s);}jq("#spnTicketAmt").html(n);jq("#spnConv").html(r);jq("#spnDisc").html(o);jq("#osDisc").show();jq(".dTotal").html(e);if(parseFloat(s)==0){jq("#dCheckMkPayBtn").hide();jq("#dvUPrcdBtn").show();jq("#dDCOffSuff").show();jq("#dSecQuikPay").hide();jq("#dSecPayOpts").hide();}if(k.val()=="7311603491979176"){fnShowPayOpts(["NetBanking"]);jq("#bnkHeading").html("ICICI NetBanking").show();jq("#cmbBnk").val("ICI-NA");jq("#dListNetBnks").hide();}jq("#descOffer").html(p).show();jq("#offCont, #dOffersSec").hide();fnBusy(false);},fnEC:function(e){if(arrSO.length>0){fnPushEventDataToAnalytics(["WR","KM"],"Payment Offer",{ProductID:arrSO[0][15],"Event Type":arrSumm[0][5],"Event Name":arrSO[0][4],"Offer code":jq("#cmbDiscOff option:selected").html(),"Offer Name":jq("#cmbDiscOff option:selected").html(),"Offer status":"Not granted","Offer value":"","Failure reason":e.substring(0,120)});}fnGlobalErr({eMess:e,eCmd:"SETPROMOTIONCODE : parameters: {offerThru: "+l+", offerType: "+b+", offerCode: "+g+"}\n Err: "+e,eRFn:"fnApplyOffer"});fnBusy(false);}});}else{if(b=="DTCN0612"){k=jq("#txtWPMMCode");a=k.val();if(k.val()==""){fnCMsgDis("errDivOf","Please enter an DLF employee code!","e");k.focus();return;}fnDoApplyOffer({offerThru:l,offerCode:b,offerKey:a});}else{if(b=="VODAFN0312"||b=="VODAAP0214"){k=jq("#txtWPMMCode");if(fnValUserDetails()){a=jq("#txtMobile").val()+"-"+k.val();if(k.val()==""){fnCMsgDis("errDivOf","Please enter the 6 digit Vodafone mcoupon received by SMS","e");k.focus();return;}if(k.val().length!=6){fnCMsgDis("errDivOf","Please enter a valid 6 digit Vodafone mcoupon received by SMS","e");k.focus();return;}fnDoApplyOffer({offerThru:l,offerCode:b,offerKey:a});}}else{if(b=="IDEA1113"){if(fnValUserDetails()){a=jq("#txtMobile").val();fnDoApplyOffer({offerThru:l,offerCode:b,offerKey:a});}}else{if(b=="OFF"){var g=jq("#cmbOffer").val();if(g=="BEN101212"){fnDoApplyOffer({offerThru:l,offerCode:g,offerKey:"6523928471831183"});}else{if(g=="CNPL0113"){fnDoApplyOffer({offerThru:l,offerCode:g,offerKey:"6521004845847555"});}else{if(g=="CNPL0413"){fnDoApplyOffer({offerThru:l,offerCode:g,offerKey:"6521004845847555"});}else{if(g=="IPLSRH0513"){fnDoApplyOffer({offerThru:l,offerCode:g,offerKey:"6521004845847555"});}else{g=jq("#cmbOffer").val();if(g==""){fnCMsgDis("errDivOf","Please select an offer!","e");return;}var c=jq("#dSecQuikPay").attr("data-paytype");var i=jq("#dSecQuikPay").attr("data-cardtype");var d=jq("input[type='radio'][name='mypay']:checked").attr("data-paytype");var j=jq("input[type='radio'][name='mypay']:checked").attr("data-cardtype");if(l=="LASTQUIKPAY"){if(c=="NB"){if(fnValUserDetails()){a=jq("#txtEmail").val()+"-"+jq("#txtMobile").val()+"-"+i.split("-")[0];}else{return;}}else{a="|MPAY=Y|";a+="MPID="+jq("#dSecQuikPay").attr("data-payid")+"|";a+="MEMBERID="+objCk.get({name:"ld",key:"MEMBERID"})+"|";a+="LSID="+objCk.get({name:"ld",key:"LSID"})+"|";a+="MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|";}}else{if(l=="MYPAY"){var f=jq("input[type='radio'][name='mypay']:checked");if(f.length==0){fnCMsgDis("errDivOf","Please select your card/netbank with which you would like to apply offer!","e");return;}if(d=="NB"){if(fnValUserDetails()){a=jq("#txtEmail").val()+"-"+jq("#txtMobile").val()+"-"+j.split("-")[0];}else{return;}}else{a="|MPAY=Y|";a+="MPID="+f.val()+"|";a+="MEMBERID="+objCk.get({name:"ld",key:"MEMBERID"})+"|";a+="LSID="+objCk.get({name:"ld",key:"LSID"})+"|";a+="MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|";}}else{if(l=="OTHER"){k=jq("#txtCardNo");if(jq("#dCDCCrd_EMI").is(":visible")){k=jq("#txtCardNo_EMI");}a=k.val().replace(/\D/g,"");k.val(jq.trim(k.val()));fnSetCard();if(jq("#dTNetBnk").hasClass("chosen")){if(jq("#dNetBnksAll").val()==""){fnCMsgDis("errDivOf","Please select a netbank with which you would like to apply the offer!","e");return;}else{if(fnValUserDetails()){a=jq("#txtEmail").val()+"-"+jq("#txtMobile").val()+"-"+jq("#dNetBnksAll").val().split("-")[0];}else{return;}}}else{if(k.val()==""){fnCMsgDis("errDivOf","Please enter your payment details above!","e");k.focus();return;}}}else{}}}fnDoApplyOffer({offerThru:l,offerCode:g,offerKey:a});}}}}}else{fnCMsgDis("errDivOf","Please select an offer type!","e");return;}}}}}}}catch(h){fnErr({fnName:"fnApplyOffer",fnParams:arguments,err:h});}}function fnDoApplyOffer(h){try{var c=h.offerThru||"OTHER";var b=h.offerCode||"";var d=h.offerKey||"";var a=jq("#cmbOffer option:checked").attr("data-offertype")||"";var g=jq("#cmbOffer option:checked").attr("data-bankcode")||"";fnBusy(true);fnDoTrans({venCode:SVC,transId:TID,cmd:"SETOFFER",p1:d,p2:b,fnCC:function(e){fnDispOffer({offerThru:c,offerCode:b,offerKey:d,data:e,offerType:a,offerBankCode:g});},fnEC:function(e){if(arrSO.length>0){fnPushEventDataToAnalytics(["WR","KM"],"Payment Offer",{ProductID:arrSO[0][15],"Event Type":arrSumm[0][5],"Event Name":arrSO[0][4],"Offer code":jq("#cmbOffer").is(":visible")?jq("#cmbOffer").val():jq("#cmbDiscOff").val(),"Offer Name":jq("#cmbOffer").is(":visible")?jq("#cmbOffer option:selected").html():jq("#cmbDiscOff option:selected").html(),"Offer status":"Not granted","Offer value":"","Failure reason":e.substring(0,120)});}fnGlobalErr({eMess:e,eCmd:"SETOFFER : parameters: {offerThru: "+c+", offerType: OFF, offerCode: "+b+"}\n Err: "+e,eRFn:"fnDoApplyOffer"});fnBusy(false);}});}catch(f){fnErr({fnName:"fnDoApplyOffer",fnParams:arguments,err:f});}}function fnDispOffer(g){try{jq("#glErrDiv").slideUp(300);var p=g.offerThru||"OTHER";var j=g.offerCode||"";var a=g.offerKey||"";var o=g.data||"";var b=g.offerType||"";var d=g.offerBankCode||"";var q=a;var f=arrSumm[0][42]+" ";var i=f+fnGVal({data:o,key:"TICKETSAMT"});var n=f+fnGVal({data:o,key:"BOOKINGFEE"});var l=fnGVal({data:o,key:"DISCOUNTAMT"});var h=f+l.toString();var c=fnGVal({data:o,key:"TOTALAMT"});lngGrandTotal=c;var m=fnGVal({data:o,key:"DISCOUNTTEXT"});if(i==""){return;}if(arrSO.length>0){fnPushEventDataToAnalytics(["WR","KM"],"Payment Offer",{ProductID:arrSO[0][15],"Event Type":arrSumm[0][5],"Event Name":arrSO[0][4],"Offer code":jq("#cmbOffer").is(":visible")?jq("#cmbOffer").val():jq("#cmbDiscOff").val(),"Offer Name":jq("#cmbOffer").is(":visible")?jq("#cmbOffer option:selected").html():jq("#cmbDiscOff option:selected").html(),"Offer status":"Granted","Offer value":l,"Failure reason":""});}jq("#spnTicketAmt").html(i);jq("#spnConv").html(n);jq("#spnDisc").html(h);jq("#osDisc").show();jq(".dTotal").html(f+c);jq("#descOffer").html(m);if(p=="LASTQUIKPAY"&&jq.inArray(j,arrAllTabsOffers)==-1){jq("#dSecPayOpts").addClass("hide");if(jq("#dSecQuikPay").attr("data-mode")=="hide"){fnDoSwitchAcc("dSecQuikPay");}}else{if((p=="MYPAY"||p=="OTHER")&&jq.inArray(j,arrAllTabsOffers)==-1){jq("#dSecQuikPay").hide();if(jq("#dSecPayOpts").attr("data-mode")=="hide"){fnDoSwitchAcc("dSecPayOpts");}}}if(p=="LASTQUIKPAY"&&jq.inArray(j,arrAllTabsOffers)==-1){if(jq.inArray(j,arrAllTabsOffers)>-1){fnShowPayOpts("ALL");}}else{if(p=="MYPAY"&&jq.inArray(j,arrAllTabsOffers)==-1){jq("#dListMyPay input[type='radio']").attr("disabled","disabled");if(jq.inArray(j,arrAllTabsOffers)>-1){fnShowPayOpts("ALL");}else{jq("#dPayTabs ul > li").not("#dTMyPay").hide();jq("#dPayConts > div").hide();jq("#dPayConts > div#dCMyPay").show();jq("#dTMyPay").unbind("click");}}else{if(p=="OTHER"&&jq.inArray(j,arrAllTabsOffers)==-1){if(b=="NetBanking"){jq("#bnkHeading").html(jq("#dNetBnksAll option[value='"+d+"']").html()).show();jq("#dNetBnksAll").val(d).hide();jq("#dListNetBnks").hide();}if(j=="AMPFIE1210"){fnShowPayOpts(["DebitCreditCard"]);jq("#txtCardNo").attr("disabled","disabled");}else{if(j=="BEN101212"){fnShowPayOpts("ALL");jq("#txtCardNo").removeAttr("disabled");jq("#txtCardNo").val("");}else{if(j=="CNPL0113"){fnShowPayOpts("ALL");jq("#txtCardNo").removeAttr("disabled");jq("#txtCardNo").val("");}else{if(j=="GOPAL0112"||j=="VODAFN0312"||j=="VODAAP0214"||j=="IMINTB2G1"||j=="IDEA1113"){jq("#txtCardNo").val("").removeAttr("disabled");jq("#dInvalidCard").hide();fnShowPayOpts("ALL");}else{if(j=="PTCPTATA"){jq("#txtCardNo").val("").removeAttr("disabled");fnShowPayOpts("ALL");}else{if(j=="HDFCSUNBUN"){jq("#txtCardNo").val(q);jq("#txtCardNo").attr("disabled","disabled");fnShowPayOpts(["DebitCreditCard"]);}else{if(j=="PTCPCITWEB"||j=="ICIDIWBOGO"){jq("#txtCardNo").val(q);jq("#txtCardNo").attr("disabled","disabled");fnShowPayOpts(["DebitCreditCard"]);}else{if(j=="ICI0611"||j=="ICI0811"){jq("#txtCardNo").attr("disabled","disabled");fnShowPayOpts(["DebitCreditCard"]);}else{if(j=="ICINB1009"){fnShowPayOpts(["NetBanking"]);jq("#bnkHeading").html("ICICI NetBanking").show();jq("#dNetBnksAll").val("ICI-NA").hide();jq("#dListNetBnks").hide();}else{if(j=="HDFCNB0910"||j=="SPIHDF0612"||j=="AISHA0810"){fnShowPayOpts(["NetBanking"]);jq("#bnkHeading").html("HDFC NetBanking").show();jq("#dNetBnksAll").val("HDF-NA").hide();jq("#dListNetBnks").hide();}else{if(j=="CITNB1109"){fnShowPayOpts(["NetBanking"]);jq("#bnkHeading").html("Citibank NetBanking").show();jq("#dNetBnksAll").val("CIT-NA").hide();jq("#dListNetBnks").hide();}else{if(j=="CITIBOGODB"){fnShowPayOpts(["DebitCreditCard"]);jq("#txtCardNo").attr("disabled","disabled");}else{if(j=="CITRW0210"){fnShowPayOpts(["RedeemPoints"]);}else{if(j=="DTCN0612"||j=="SHATAN0611"){fnShowPayOpts("ALL");jq("#txtCardNo").val("").removeAttr("disabled");}else{if(j=="IMINT50110"){fnShowPayOpts("ALL");jq("#chkLoyPoints").attr("checked","checked");jq("#txtCardNo").val("").removeAttr("disabled");jq("#dPoints").show();jq("#imintcant").show();jq("#cmbRP").val("imint");jq("#imint").val("");jq("#cmbRP").show().attr("disabled","disabled");}else{if(b=="NetBanking"){fnShowPayOpts(["NetBanking"]);}else{fnShowPayOpts(["DebitCreditCard"]);jq("#txtCardNo").attr("disabled","disabled");}}}}}}}}}}}}}}}}}else{}}}IsOfferApplied=true;jq("#descOffer").show();jq("#dOffersSec").hide();jq("#offCont").hide();if(parseInt(c,10)==0){jq("#dCheckMkPayBtn").hide();jq("#dvUPrcdBtn").show();jq("#dDCOffSuff").show();jq("#dSecQuikPay").hide();jq("#dSecPayOpts").hide();}fnBusy(false);}catch(k){fnErr({fnName:"fnDispOffer",fnParams:arguments,err:k});}}function fnZeroCommit(){try{if(fnValUserDetails()){var a=jq("#chkFB");var h="|TYPE=WINPIN|CARDNO=WINPIN|";var g=jq("#imint");var d="";var c=jq("#cmbRP");var b=jq("#chkPolicyZComm");if(g.val()!=""&&c.val()=="imint"){if(isNaN(g.val())||(g.val().length==16&&g.val().substring(0,6)!="940115")||g.val().length<10){fnCMsgDis("errDivDPts","Please enter a valid imint number.","e");g.focus();return;}d="|MEMBERTYPE=IMINT|MEMBERNO="+g.val()+"|";}if(a.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&a.is(":checked")){d+=(d==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){d=((d=="")?"|":"")+"ETICKET=Y|";}if(!b.is(":checked")){fnCMsgDis("errDivZcom","Please agree to the Terms and Conditions before continuing.","e");return;}fnBusy(true);fnDoTrans({venCode:SVC,transId:TID,cmd:"COMMITTRANS",p1:h,p2:fnGetContactDetails(),p3:d,p4:"N",fnCC:function(e){objCk.set({name:"BOOKINGID",value:fnGVal({data:e,key:"BOOKINGID"})});jq("#fBid").submit();},fnEC:function(e){objCk.del({name:"lngTransId"});objCk.del({name:"BOOKINGID"});fnBusy(false);}});}}catch(f){fnErr({fnName:"fnZeroCommit",fnParams:arguments,err:f});}}var strPGPostUrl="https://services.in.bookmyshow.com/payserv/doPGPost.aspx";function fnPayCard(){try{if(fnValUserDetails()){var b=jq("#chkFB");var h="";var g="";var a=jq("#txtPin");var p=jq("#imint");var m="";var d=jq("#cmbRP");var f=jq("#txtCardName");var c=jq("#txtCardNo");var o=jq("#txtCVV");var j=jq("#cmbExpMonth");var k=jq("#cmbExpYear");var n=jq("#chkPolicyTick");var q=jq("#cmbCardCat");var l=jq("#txtDCCardDesc");switch(q.val().toUpperCase()){case"VISA":case"MASTERCARD":case"MC":case"HDFCDEBIT":case"ICICIDEBIT":h="|TYPE=CREDIT|";if(dcPaymentMode=="2"){h="|TYPE=DEBIT|";}break;case"AMEX":h="|TYPE=AMEX|";break;case"RUPAY":case"MAESTRO":h="|TYPE=PAYUCARD|";break;case"SDC-DIRECT":case"SPG-DIRECT":case"CIT-NA":h="|TYPE=NETBANKING|";break;default:alert("Invalid Payment Type");return;}if(jq("#chkLoyPoints").is(":checked")&&d.val()=="imint"){if(p.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");p.focus();return;}if(isNaN(p.val())||(p.val().length==16&&p.val().substring(0,6)!="940115")||p.val().length<10||(p.val().length>10&&p.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");p.focus();return;}if(fnVal.mob(p.val())&&p.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");p.focus();return;}m="|MEMBERTYPE=IMINT|MEMBERNO="+p.val()+"|";}if(b.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&b.is(":checked")){m+=(m==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){m=((m=="")?"|":"")+"ETICKET=Y|";}c.val(jq.trim(c.val()));switch(q.val().toUpperCase()){case"VISA":if(c.val().replace(/\D/g,"").length<13||isNaN(c.val().replace(/\D/g,""))==true||c.val().replace(/\D/g,"").substring(0,1)!="4"||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC","Please enter a valid Card Number!","e");c.focus();return;}break;case"MASTERCARD":if(c.val().replace(/\D/g,"").length<16||isNaN(c.val().replace(/\D/g,""))==true||c.val().replace(/\D/g,"").substring(0,1)!="5"||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC","Please enter a valid Card Number!","e");c.focus();return;}break;case"AMEX":if(c.val().replace(/\D/g,"").length!=15||isNaN(c.val().replace(/\D/g,""))==true||c.val().replace(/\D/g,"").substring(0,1)!="3"||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC","Please enter a valid Card Number!","e");c.focus();return;}break;case"MAESTRO":if(c.val().replace(/\D/g,"").length<12||c.val().replace(/\D/g,"").length>19||isNaN(c.val().replace(/\D/g,""))==true||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC","Please enter a valid Card Number!","e");c.focus();return;}break;case"RUPAY":if(isNaN(c.val().replace(/\D/g,""))==true||!fnLuhnCheck(c.val().replace(/\D/g,""))||c.val().replace(/\D/g,"").length!=16){fnCMsgDis("errDivDC","Please enter a valid Card Number!","e");c.focus();return;}break;}if(f.val()==""||fnVal.chkName(f.val())==false){fnCMsgDis("errDivDC","Please enter a valid Card Name.","e");f.focus();return;}if(q.val().toUpperCase()=="MAESTRO"){if(k.val()!=""&&j.val()==""){fnCMsgDis("errDivDC","Please select an Expiry Month.","e");j.focus();return;}if(j.val()!=""&&k.val()==""){fnCMsgDis("errDivDC","Please select an Expiry Year.","e");j.focus();return;}}else{if(j.val()==""){fnCMsgDis("errDivDC","Please select an Expiry Month.","e");j.focus();return;}if(k.val()==""){fnCMsgDis("errDivDC","Please select an Expiry Year.","e");j.focus();return;}}if(j.val()!=""&&k.val()!=""&&(k.val()+""+j.val())<curDt){fnCMsgDis("errDivDC","Please check the expiry date of your card.","e");k.focus();return;}if(o.val().length<3||isNaN(o.val())==true){if(q.val().toUpperCase()!="MAESTRO"){fnCMsgDis("errDivDC","Please enter a valid CVV Code.","e");o.focus();return;}}if(q.val().toUpperCase()=="AMEX"&&(a.val().length<3)==true){fnCMsgDis("errDivDC","Please enter a valid Pin Code.","e");a.focus();return;}if(!n.is(":checked")){fnCMsgDis("errDivDC","Please agree to the Terms and Conditions before continuing ...","e");return;}if(jq("#chkSaveDCAsk").is(":checked")){if(jq.trim(l.val())!=""&&!/^[a-zA-Z \\\/;:.,-]+$/g.test(l.val())){fnCMsgDis("errDivDC","Please enter a valid card description.","e");l.focus();return;}g+="MPAY=Y|";g+="MPID=0|";g+="MEMBERID="+objCk.get({name:"ld",key:"MEMBERID"})+"|";g+="LSID="+objCk.get({name:"ld",key:"LSID"})+"|";g+="MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|";g+="MPTYPECODE="+q.val().toUpperCase()+"|";g+="MPAYDESC="+l.val()+"|";g+="MPAYTYPE=CD|";}h+="CARDNO="+c.val().replace(/\D/g,"")+"|";if(q.val().toUpperCase()=="MAESTRO"){h+="CARDTYPE=MAESTRO|";}else{h+="CARDTYPE=ICICIDEBIT|";}if(q.val().toUpperCase()=="MAESTRO"){if(j.val()!=""&&k.val()!=""){h+="EXPIRY="+k.val()+j.val()+"|";}else{h+="EXPIRY=204912|";}}else{h+="EXPIRY="+k.val()+j.val()+"|";}h+="CVV="+o.val()+"|";h+="NAME="+f.val()+"|";if(a&&q.val().toUpperCase()=="AMEX"){h+="POSTCODE="+a.val()+"|";}fnDisableSubmit("PROCESSING",function(){jq("#strPaymentString").val(h+g);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(m);var e=jq("#frmCreditDtls");e.attr("action",strPGPostUrl);e.submit();});}}catch(i){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:i});}}function fnPayNetBank(){try{if(fnValUserDetails()){var b=jq("#chkFB");var g="";var f="";var a=jq("#txtPin");var k=jq("#imint");var i="";var c=jq("#cmbRP");var d=jq("#dNetBnksAll");var j=jq("#chkPolicyTick");if(d.val()==""){fnCMsgDis("errDivNB","Please select online bank account.","e");d.focus();return;}if(jq("#chkLoyPoints").is(":checked")&&c.val()=="imint"){if(k.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");k.focus();return;}if(isNaN(k.val())||(k.val().length==16&&k.val().substring(0,6)!="940115")||k.val().length<10||(k.val().length>10&&k.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");k.focus();return;}if(fnVal.mob(k.val())&&k.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");k.focus();return;}i="|MEMBERTYPE=IMINT|MEMBERNO="+k.val()+"|";}if(b.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&b.is(":checked")){i+=(i==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){i=((i=="")?"|":"")+"ETICKET=Y|";}if(!j.is(":checked")){fnCMsgDis("errDivNB","Please agree to the Terms and Conditions before continuing ...","e");return;}if(jq("#chkSaveNBAsk").is(":checked")){f+="MPAY=Y|";f+="MPID=0|";f+="MEMBERID="+objCk.get({name:"ld",key:"MEMBERID"})+"|";f+="LSID="+objCk.get({name:"ld",key:"LSID"})+"|";f+="MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|";f+="MPTYPECODE="+d.val().toUpperCase()+"|";f+="MPAYDESC="+d.find("option:selected").html()+"|";f+="MPAYTYPE=NB|";}fnDisableSubmit("PROCESSING",function(){var l=jq("#frmCreditDtls");var e=d.val().split("-");if(e[0]=="120"||e[0]=="170"||e[0]=="200"||e[0]=="340"||e[0]=="450"){g="|TYPE=TPSL|BANKID="+e[0]+"|";}else{g="|TYPE=NETBANKING|BANKID="+e[0]+"|ITEMCODE="+e[1]+"|";}jq("#strPaymentString").val(g+f);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(i);l.attr("action",strPGPostUrl);l.submit();});}}catch(h){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:h});}}function fnPayCashCards(){try{if(fnValUserDetails()){var b=jq("#chkFB");var i="";var a=jq("#txtPin");var q=jq("#imint");var m="";var c=jq("#cmbRP");var p=jq("#chkPolicyTick");var o=jq("#cmbCashCardType");var l="";var i="";var f="";var n="";var h=/^([a-zA-Z\s\.-]+)$/;var d=/[^a-zA-Z0-9]/g;if(jq("#chkLoyPoints").is(":checked")&&c.val()=="imint"){if(q.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");q.focus();return;}if(isNaN(q.val())||(q.val().length==16&&q.val().substring(0,6)!="940115")||q.val().length<10||(q.val().length>10&&q.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");q.focus();return;}if(fnVal.mob(q.val())&&q.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");q.focus();return;}m="|MEMBERTYPE=IMINT|MEMBERNO="+q.val()+"|";}if(b.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&b.is(":checked")){m+=(m==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){m=((m=="")?"|":"")+"ETICKET=Y|";}var g=o.val().split("-");switch(g[0].toUpperCase()){case"ZPG":l="|TYPE=NETBANKING|BANKID="+g[0]+"|ITEMCODE="+g[1]+"|";break;case"OXI":n=jq("#txtOxiName");i=jq("#txtOxiCardNo");f=jq("#txtOxiPwd");if(!n.val().match(h)){fnCMsgDis("errDivCC","Please enter a valid Card Name.","e");n.focus();return;}if(isNaN(i.val())||i.val().length!=10){fnCMsgDis("errDivCC","Please enter a valid Mobile Number.","e");i.focus();return;}if(isNaN(f.val())||f.val().length!=6){fnCMsgDis("errDivCC","Please enter a valid Password.","e");f.focus();return;}l="|TYPE=OXICASH|CardNo="+i.val()+"|Password="+f.val()+"|Name="+n.val()+"|";break;case"OXICARD":n=jq("#txtOxiCardName");i=jq("#txtOxiCardCardNo");f=jq("#txtOxiCardPwd");if(n.val()==""||n.val().search(d)!=-1){fnCMsgDis("errDivCC","Please enter a valid Card Name.","e");n.focus();return;}if(isNaN(i.val())||i.val().length<12){fnCMsgDis("errDivCC","Please enter a valid Card Number.","e");i.focus();return;}if(isNaN(f.val())||f.val().length!=6){fnCMsgDis("errDivCC","Please enter a valid Password.","e");f.focus();return;}l="|TYPE=OXICASHCARD|CardNo="+i.val()+"|Password="+f.val()+"|Name="+n.val()+"|";break;case"DONE":i=jq("#txtDoneCardNo");f=jq("#txtDonePwd");n=jq("#txtDoneName");if(!n.val().match(h)){fnCMsgDis("errDivCC","Please enter a valid Name.","e");n.focus();return;}if(isNaN(i.val())||i.val().length!=14){fnCMsgDis("errDivCC","Please enter a valid Card Number.","e");i.focus();return;}if(isNaN(f.val())||f.val().length!=4){fnCMsgDis("errDivCC","Please enter a valid Password.","e");f.focus();return;}l="|TYPE=DONECARD|CardNo="+i.val()+"|Password="+f.val()+"|Name="+n.val()+"|";break;case"ATL":l="|TYPE=NETBANKING|BANKID="+g[0]+"|ITEMCODE="+g[1]+"|";break;case"AMEXEZE":l="|TYPE="+g[0]+"|";break;case"PAYUWALLET":l="|TYPE="+g[0]+"|BankId="+g[1]+"|";break;case"VM2":l="|TYPE=NETBANKING|BANKID="+g[0]+"|ITEMCODE="+g[1]+"|";break;case"IMS":l="|TYPE=NETBANKING|BANKID="+g[0]+"|ITEMCODE="+g[1]+"|";break;case"PCH":l="|TYPE=NETBANKING|BANKID="+g[0]+"|ITEMCODE="+g[1]+"|";break;case"BEAM":i=jq("#txtBeamCardNo");f=jq("#txtBeamPwd");n=jq("#txtBeamName");if(!n.val().match(h)){fnCMsgDis("errDivCC","Please enter a valid Name.","e");n.focus();return;}if(i.val().length<10||i.val().search(d)!=-1){fnCMsgDis("errDivCC","Please enter a valid Card Number.","e");i.focus();return;}if(isNaN(f.val())||f.val().length!=6){fnCMsgDis("errDivCC","Please enter a valid Password.","e");f.focus();return;}l="|TYPE=BEAM|UserName="+i.val()+"|Password="+f.val()+"|Name="+n.val()+"|";break;case"ITZCASH":n=jq("#txtItzCashName");if(!n.val().match(h)){fnCMsgDis("errDivCC","Please enter a valid Name.","e");n.focus();return;}l="|TYPE=ITZCASH|Name="+n.val()+"|";break;case"IMINTCARD":n=jq("#txtImintName");if(!n.val().match(h)){fnCMsgDis("errDivCC","Please enter a valid Name.","e");n.focus();return;}l="|TYPE=IMINT|Name="+n.val()+"|";break;case"YPAY":l="|TYPE=PAYU|BANKID="+g[0]+"|ITEMCODE="+g[1]+"|";break;case"MOBIKWIK":var k=jq("#txtMobiKwikEmail");var r=jq("#txtMobiKwikMobile");if(jq.trim(k.val())==""||!fnVal.email(jq.trim(k.val()))){fnCMsgDis("errDivCC","Please enter a valid email address.","e");k.focus();return;}if(jq.trim(r.val())==""||!fnVal.mob(jq.trim(r.val()))){fnCMsgDis("errDivCC","Please enter a valid mobile number.","e");r.focus();return;}l="|TYPE=MOBIKWIK|Email="+jq.trim(k.val())+"|Mobile="+jq.trim(r.val())+"|";break;default:fnCMsgDis("errDivCC","Invalid Payment Type","e");return;}if(!p.is(":checked")){fnCMsgDis("errDivCC","Please agree to the Terms and Conditions before continuing ...","e");return;}fnDisableSubmit("PROCESSING",function(){var e=jq("#frmCreditDtls");jq("#strPaymentString").val(l);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(m);e.attr("action",strPGPostUrl);e.submit();});}}catch(j){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:j});}}function fnApplyGV(){try{if(fnValUserDetails()){var a=jq("#txtGVCode");if(jq.trim(a.val())==""){fnCMsgDis("errDivGV","Please enter a Gift Voucher code","e");a.focus();return;}if(/[^a-zA-Z0-9]/g.test(a.val())){fnCMsgDis("errDivGV","Please enter a valid Gift Voucher code","e");a.focus();return;}fnBusy(true);fnDoTrans({venCode:SVC,transId:TID,cmd:"REDEEMVOUCHER",p1:arrSumm[0][0],p2:jq.trim(a.val()),fnCC:function(i){fnBusy(false);var f=fnGVal({data:i,key:"TICKETSAMT"});var g=fnGVal({data:i,key:"BOOKINGFEE"});var h=fnGVal({data:i,key:"VOUCHERAMT"});var e=fnGVal({data:i,key:"TOTALAMT"});var d=fnGVal({data:i,key:"BALANCE"});totGVAmt=parseInt(totGVAmt,10)+parseInt(h,10);var c=arrSumm[0][42]+" ";isOfferApplied=true;lngGrandTotal=parseFloat(e).toFixed(2);jq(".dTotal").html(arrSumm[0][42]+" "+lngGrandTotal);if(d=="Y"){GVCounter+=1;jq("#cardSumm").html("Gift Card Used "+GVCounter+" : "+c+totGVAmt).show();jq("#dAddGV").html("Enter one more GV Number : ");jq("#otherOptions").show();jq("#txtGVCode").val("").focus();}else{GVCounter+=1;jq("#dSecQuikPay").hide();jq("#cardSumm").html("Gift Card Used "+GVCounter+" : "+c+totGVAmt).show();jq("#dAddGV").hide();jq("#otherOptions").hide();jq("#dGvData").hide();jq("#lnkGV").hide();jq("#dGVSuff").show();jq("#btnMakePayment").show();jq("#dCheckMkPayBtn").show();jq.each(oPayTabs,function(j,k){jq("#"+k.tabId).removeAttr("onclick");jq("#"+k.tabId).unbind("click");});}},fnEC:function(c){fnBusy(false);fnCMsgDis("errDivGV",c,"e");}});}}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}function fnPayGiftVoucher(){try{if(fnValUserDetails()){var a=jq("#chkFB");var h="";var g=jq("#imint");var d="";var c=jq("#cmbRP");var b=jq("#chkPolicyTick");if(!b.is(":checked")){fnCMsgDis("errDivGV","Please agree to the Terms and Conditions before continuing ...","e");return;}fnBusy(true);if(jq("#chkLoyPoints").is(":checked")&&c.val()=="imint"){if(g.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");g.focus();return;}if(isNaN(g.val())||(g.val().length==16&&g.val().substring(0,6)!="940115")||g.val().length<10||(g.val().length>10&&g.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");g.focus();return;}if(fnVal.mob(g.val())&&g.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");g.focus();return;}d="|MEMBERTYPE=IMINT|MEMBERNO="+g.val()+"|";}if(a.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&a.is(":checked")){d+=(d==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){d=((d=="")?"|":"")+"ETICKET=Y|";}fnDoTrans({venCode:SVC,transId:TID,cmd:"COMMITTRANS",p1:"|TYPE=GV|CARDNO=GV|",p2:fnGetContactDetails(),p3:d,p4:"N",fnCC:function(e){objCk.set({name:"BOOKINGID",value:fnGVal({data:e,key:"BOOKINGID"})});jq("#fBid").submit();},fnEC:function(e){objCk.del({name:"lngTransId"});objCk.del({name:"BOOKINGID"});fnBusy(false);}});}}catch(f){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:f});}}function fnGetPaybackPoints(d){try{var c=jq("#txtCheckPaybackNo");var a=jq("#txtCheckPaybackPin");fnDoTrans({AppC:AppC,venCode:SVC,transId:TID,cmd:"GETIMINTS2SBALANCEPOINTS",p1:"|TYPE=IMINTS2S|MOBILEORCARDNO="+jq.trim(c.val())+"|PIN="+jq.trim(a.val())+"|",blnSupp:true,fnCC:function(e){var f=fnGVal({data:e,key:"SufficientPointsForTransaction",defVal:""});d({success:true,error:""},{SufficientPointsForTransaction:f});},ecObj:true,fnEC:function(e){d({success:false,error:e.strException},"");}});}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}function fnCheckPaybackPoints(){try{var c=jq("#txtCheckPaybackNo");var a=jq("#txtCheckPaybackPin");if(c.val()==""){fnCMsgDis("errDivRP","Please enter a PAYBACK/mobile number.","e");c.focus();return;}else{if(isNaN(c.val())||(c.val().length==16&&c.val().substring(0,6)!="940115")||c.val().length<10||(c.val().length>10&&c.val().length!=16)){fnCMsgDis("errDivRP","Please enter a valid PAYBACK/mobile number.","e");c.focus();return;}}if(a.val()==""){fnCMsgDis("errDivRP","Please enter your PAYBACK pin.","e");a.focus();return;}else{if(isNaN(a.val())||a.val().length!=4){fnCMsgDis("errDivRP","Please enter a valid PAYBACK pin.","e");a.focus();return;}}jq("#dPaybackStatus, #errDivRP").hide();fnBusy(true);fnGetPaybackPoints(function(d,e){fnBusy(false);if(d.success==true){if(e.SufficientPointsForTransaction=="Y"){jq("#dPaybackStatus").removeClass("error").addClass("success").html('<div class="sucicon ic-flag"></div><div class="errtxt">Congrats, you have enough points in your PAYBACK account for this transaction.</div>').animate({height:"toggle",opacity:"fast"});}else{jq("#dPaybackStatus").removeClass("success").addClass("error").html('<div class="erricon ic-warn"></div><div class="errtxt">Sorry, you don\'t have enough points in your PAYBACK account for this transaction. Please choose any other option.</div>').animate({height:"toggle",opacity:"fast"});}}else{fnCMsgDis("errDivRP",d.error,"e");}});}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}function fnPayPoints(){try{jq("#dPaybackStatus, #errDivRP").hide();if(fnValUserDetails()){var b=jq("#chkFB");var j="";var a=jq("#txtPin");var n=jq("#imint");var k="";var d=jq("#cmbRP");var m=jq("#chkPolicyTick");var f=jq("#txtBnkCitiReward");var c=jq("#txtCheckPaybackNo");var a=jq("#txtCheckPaybackPin");if(jq("#chkLoyPoints").is(":checked")&&d.val()=="imint"){if(n.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");n.focus();return;}if(isNaN(n.val())||(n.val().length==16&&n.val().substring(0,6)!="940115")||n.val().length<10||(n.val().length>10&&n.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");n.focus();return;}if(fnVal.mob(n.val())&&n.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");n.focus();return;}k="|MEMBERTYPE=IMINT|MEMBERNO="+n.val()+"|";}if(b.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&b.is(":checked")){k+=(k==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){k=((k=="")?"|":"")+"ETICKET=Y|";}if(f.val()==""){fnCMsgDis("errDivRP","Please select reward","e");return;}jq("#liImint").hide();if(f.val()=="IMINTCARD"){var h=/^([a-zA-Z\s\.-]+)$/;jq("#liImint").show();var l=jq("#txtImintName");if(!fnVal.chkName(l.val())){fnCMsgDis("errDivRP","Please enter a valid Name.","e");l.focus();return;}if(c.val()==""){fnCMsgDis("errDivRP","Please enter a PAYBACK/mobile number.","e");c.focus();return;}else{if(isNaN(c.val())||(c.val().length==16&&c.val().substring(0,6)!="940115")||c.val().length<10||(c.val().length>10&&c.val().length!=16)){fnCMsgDis("errDivRP","Please enter a valid PAYBACK/mobile number.","e");c.focus();return;}}if(a.val()==""){fnCMsgDis("errDivRP","Please enter your PAYBACK pin.","e");a.focus();return;}else{if(isNaN(a.val())||a.val().length!=4){fnCMsgDis("errDivRP","Please enter a valid PAYBACK pin.","e");a.focus();return;}}if(!m.is(":checked")){fnCMsgDis("errDivRP","Please agree to the Terms and Conditions before continuing ...","e");return;}fnBusy(true);fnGetPaybackPoints(function(e,o){if(e.success==true){if(o.SufficientPointsForTransaction=="Y"){j="|TYPE=IMINT|Name="+l.val()+"|";fnDisableSubmit("PROCESSING",function(){var p=jq("#frmCreditDtls");jq("#strPaymentString").val(j);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(k);p.attr("action",strPGPostUrl);p.submit();});}else{alert("Sorry, you don't have enough points in your PAYBACK account for this transaction. Please choose any other option.");fnBusy(false);return;}}else{j="|TYPE=IMINT|Name="+l.val()+"|";fnDisableSubmit("PROCESSING",function(){var p=jq("#frmCreditDtls");jq("#strPaymentString").val(j);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(k);p.attr("action",strPGPostUrl);p.submit();});}});}else{var g=f.val().split("-");j="|TYPE=NETBANKING|BANKID="+g[0]+"|ITEMCODE="+g[1]+"|";fnDisableSubmit("PROCESSING",function(){var e=jq("#frmCreditDtls");jq("#strPaymentString").val(j);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(k);e.attr("action",strPGPostUrl);e.submit();});}}}catch(i){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:i});}}function fnPayPayPal(){try{if(fnValUserDetails()){var a=jq("#chkFB");var f=jq("#txtPin");var h=jq("#imint");var d="";var c=jq("#cmbRP");var b=jq("#chkPolicyTick");if(jq("#chkLoyPoints").is(":checked")&&c.val()=="imint"){if(h.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");h.focus();return;}if(isNaN(h.val())||(h.val().length==16&&h.val().substring(0,6)!="940115")||h.val().length<10||(h.val().length>10&&h.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");h.focus();return;}if(fnVal.mob(h.val())&&h.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");h.focus();return;}d="|MEMBERTYPE=IMINT|MEMBERNO="+h.val()+"|";}if(a.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&a.is(":checked")){d+=(d==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){d=((d=="")?"|":"")+"ETICKET=Y|";}if(!b.is(":checked")){fnCMsgDis("errDivPP","Please agree to the Terms and Conditions before continuing ...","e");return;}fnDisableSubmit("PROCESSING",function(){var e=jq("#frmCreditDtls");jq("#strPaymentString").val("|TYPE=PAYPAL|");jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(d);e.attr("action",strPGPostUrl);e.submit();});}}catch(g){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:g});}}function fnPayAmexEzeClick(){try{if(fnValUserDetails()){var a=jq("#chkFB");var f=jq("#txtPin");var h=jq("#imint");var d="";var c=jq("#cmbRP");var b=jq("#chkPolicyTick");if(jq("#chkLoyPoints").is(":checked")&&c.val()=="imint"){if(h.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");h.focus();return;}if(isNaN(h.val())||(h.val().length==16&&h.val().substring(0,6)!="940115")||h.val().length<10||(h.val().length>10&&h.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");h.focus();return;}if(fnVal.mob(h.val())&&h.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");h.focus();return;}d="|MEMBERTYPE=IMINT|MEMBERNO="+h.val()+"|";}if(a.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&a.is(":checked")){d+=(d==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){d=((d=="")?"|":"")+"ETICKET=Y|";}if(!b.is(":checked")){fnCMsgDis("errDivEZ","Please agree to the Terms and Conditions before continuing ...","e");return;}fnDisableSubmit("PROCESSING",function(){var e=jq("#frmCreditDtls");jq("#strPaymentString").val("|TYPE=AMEXEZE|");jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(d);e.attr("action",strPGPostUrl);e.submit();});}}catch(g){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:g});}}function fnPayPayUWallet(){try{if(fnValUserDetails()){var a=jq("#chkFB");var h=jq("#imint");var c=jq("#cmbRP");var b=jq("#chkPolicyTick");var d="";var f="";if(jq("#chkLoyPoints").is(":checked")&&c.val()=="imint"){if(h.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");h.focus();return;}if(isNaN(h.val())||(h.val().length==16&&h.val().substring(0,6)!="940115")||h.val().length<10){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");h.focus();return;}if(fnVal.mob(h.val())&&h.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");h.focus();return;}f="|MEMBERTYPE=IMINT|MEMBERNO="+h.val()+"|";}if(a.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&a.is(":checked")){f+=(f==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){f=((f=="")?"|":"")+"ETICKET=Y|";}if(!b.is(":checked")){fnCMsgDis("errDivPUM","Please agree to the Terms and Conditions before continuing ...","e");return;}fnDisableSubmit("PROCESSING",function(){d="|TYPE=PAYUWALLET|BankId=Payuw|";jq("#strPaymentString").val(d);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(f);var e=jq("#frmCreditDtls");e.attr("action",strPGPostUrl);e.submit();});}}catch(g){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:g});}}function fnPayCard_EMI(){try{if(fnValUserDetails()){var b=jq("#chkFB");var h="";var g="";var a=jq("#txtPin");var p=jq("#imint");var m="";var d=jq("#cmbRP");var q=jq("tr input[type='radio'][name='emi-option']:checked").val();var f=jq("#txtCardName_EMI");var c=jq("#txtCardNo_EMI");var o=jq("#txtCVV_EMI");var j=jq("#cmbExpMonth_EMI");var k=jq("#cmbExpYear_EMI");var n=jq("#chkPolicyTick");var r=jq("#cmbCardCat_EMI");var l=jq("#txtDCCardDesc_EMI");h="|TYPE=PAYUEMI|";if(jq("#chkLoyPoints").is(":checked")&&d.val()=="imint"){if(p.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");p.focus();return;}if(isNaN(p.val())||(p.val().length==16&&p.val().substring(0,6)!="940115")||p.val().length<10||(p.val().length>10&&p.val().length!=16)){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");p.focus();return;}if(fnVal.mob(p.val())&&p.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");p.focus();return;}m="|MEMBERTYPE=IMINT|MEMBERNO="+p.val()+"|";}if(b.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&b.is(":checked")){m+=(m==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){m=((m=="")?"|":"")+"ETICKET=Y|";}c.val(jq.trim(c.val()));switch(r.val().toUpperCase()){case"VISA":if(c.val().replace(/\D/g,"").length<13||isNaN(c.val().replace(/\D/g,""))==true||c.val().replace(/\D/g,"").substring(0,1)!="4"||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC_EMI","Please enter a valid Card Number!","e");c.focus();return;}break;case"MASTERCARD":if(c.val().replace(/\D/g,"").length<16||isNaN(c.val().replace(/\D/g,""))==true||c.val().replace(/\D/g,"").substring(0,1)!="5"||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC_EMI","Please enter a valid Card Number!","e");c.focus();return;}break;case"AMEX":if(c.val().replace(/\D/g,"").length!=15||isNaN(c.val().replace(/\D/g,""))==true||c.val().replace(/\D/g,"").substring(0,1)!="3"||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC_EMI","Please enter a valid Card Number!","e");c.focus();return;}break;case"MAESTRO":if(c.val().replace(/\D/g,"").length<12||c.val().replace(/\D/g,"").length>19||isNaN(c.val().replace(/\D/g,""))==true||!fnLuhnCheck(c.val().replace(/\D/g,""))){fnCMsgDis("errDivDC_EMI","Please enter a valid Card Number!","e");c.focus();return;}break;case"RUPAY":if(isNaN(c.val().replace(/\D/g,""))==true||!fnLuhnCheck(c.val().replace(/\D/g,""))||c.val().replace(/\D/g,"").length!=16){fnCMsgDis("errDivDC","Please enter a valid Card Number!","e");c.focus();return;}break;}if(q==undefined){fnCMsgDis("errDivDC_EMI","Please choose an EMI option.","e");return;}if(f.val()==""||fnVal.chkName(f.val())==false){fnCMsgDis("errDivDC_EMI","Please enter a valid Card Name.","e");f.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}if(r.val().toUpperCase()=="MAESTRO"){if(k.val()!=""&&j.val()==""){fnCMsgDis("errDivDC_EMI","Please select an Expiry Month.","e");j.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}if(j.val()!=""&&k.val()==""){fnCMsgDis("errDivDC_EMI","Please select an Expiry Year.","e");j.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}}else{if(j.val()==""){fnCMsgDis("errDivDC_EMI","Please select an Expiry Month.","e");j.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}if(k.val()==""){fnCMsgDis("errDivDC_EMI","Please select an Expiry Year.","e");j.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}}if(j.val()!=""&&k.val()!=""&&(k.val()+""+j.val())<curDt){fnCMsgDis("errDivDC_EMI","Please check the expiry date of your card.","e");k.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}if(o.val().length<3||isNaN(o.val())==true){if(r.val().toUpperCase()!="MAESTRO"){fnCMsgDis("errDivDC_EMI","Please enter a valid CVV Code.","e");o.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}}if(r.val().toUpperCase()=="AMEX"&&(a.val().length<6)==true){fnCMsgDis("errDivDC_EMI","Please enter a valid Pin Code.","e");a.focus();setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}if(!n.is(":checked")){fnCMsgDis("errDivDC_EMI","Please agree to the Terms and Conditions before continuing ...","e");setTimeout(function(){jq("#dPayConts").animate({scrollTop:"500px"},500);},100);return;}if(jq("#chkSaveDCAsk").is(":checked")){if(jq.trim(l.val())!=""&&!/^[a-zA-Z \\\/;:.,-]+$/g.test(l.val())){fnCMsgDis("errDivDC","Please enter a valid card description.","e");l.focus();return;}g+="MPAY=Y|";g+="MPID=0|";g+="MEMBERID="+objCk.get({name:"ld",key:"MEMBERID"})+"|";g+="LSID="+objCk.get({name:"ld",key:"LSID"})+"|";g+="MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|";g+="MPTYPECODE="+r.val().toUpperCase()+"|";g+="MPAYDESC="+l.val()+"|";g+="MPAYTYPE=CD|";}fnDisableSubmit("PROCESSING",function(){h+="CARDNO="+c.val().replace(/\D/g,"")+"|";if(r.val().toUpperCase()=="MAESTRO"){if(j.val()!=""&&k.val()!=""){h+="EXPIRY="+k.val()+j.val()+"|";}else{h+="EXPIRY=204912|";}}else{h+="EXPIRY="+k.val()+j.val()+"|";}h+="CVV="+o.val()+"|";h+="NAME="+f.val()+"|";if(a&&r.val().toUpperCase()=="AMEX"){h+="POSTCODE="+a.val()+"|";}h+="EMIType="+q+"|";jq("#strPaymentString").val(h+g);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(m);var e=jq("#frmCreditDtls");e.attr("action",strPGPostUrl);e.submit();});}}catch(i){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:i});}}var oMyPay={};oMyPay.fnListPayOpts=function(c){try{var b={AppC:global.AppC,memberId:objCk.get({name:"ld",key:"MEMBERID"}),lsid:objCk.get({name:"ld",key:"LSID"}),payStatus:"Y",format:"jsa",memberSeq:objCk.get({name:"ld",key:"SEQUENCE"}),payType:""};c=jq.extend(b,c);fnDoTrans({AppC:c.AppC,cmd:"LISTMYPAYMENTDETAILS",p1:c.memberId,p2:c.lsid,p3:c.payStatus,p4:c.format,p5:c.memberSeq,p6:c.payType,secure:true,fnCC:function(d){jq.globalEval(unescape(d));if(jq.trim(Status[0][0].toUpperCase())=="TRUE"){if(c.success){c.success(d);}}else{if(c.error){c.error(Status[0][1]+"~"+Status[0][2]);}}},fnEC:function(d){if(c.error){c.error(d);}}});}catch(a){fnErr({fnName:"oMyPay.fnListPayOpts",fnParams:arguments,err:a});}};oMyPay.fnAddPayOpt=function(c){try{var b={AppC:global.AppC,memberId:objCk.get({name:"ld",key:"MEMBERID"}),lsid:objCk.get({name:"ld",key:"LSID"}),cardId:"0",payDesc:"",payType:"",payString:"",payStatus:"A",expiry:"",mPayType:"",listAll:"Y",listDetails:"Y",transStr:"|TRANSID=0|MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|FORMAT=jsa|",paySeq:"",success:false,error:false};c=jq.extend(b,c);c.transStr+="MPTYPECODE="+c.mPayType+"|";c.transStr+="ISLISTDETAILS="+c.listDetails+"|";c.transStr+="LISTALL="+c.listAll+"|";fnDoTrans({AppC:c.AppC,cmd:"SAVEMYPAYMENTDETAILS",p1:c.memberId,p2:c.lsid,p3:c.cardId,p4:c.payDesc,p5:c.payType,p6:c.payString,p7:c.payStatus,p8:c.expiry,p9:c.transStr,p10:c.paySeq,secure:true,blnSupp:true,ecObj:true,fnCC:function(d){jq.globalEval(unescape(d));if(jq.trim(Status[0][0].toUpperCase())=="TRUE"){if(c.success){c.success(d);}}else{if(c.error){if(Status&&Status[0]&&Status[0][1]){c.error(Status[0][1]+"~"+Status[0][2]);}}}},fnEC:function(d){if(c.error){c.error(d.intExceptionEx+"~"+d.strException);}}});}catch(a){fnErr({fnName:"oMyPay.fnAddPayOpt",fnParams:arguments,err:a});}};oMyPay.fnRemPayOpt=function(c){try{var b={AppC:global.AppC,cardId:"0",memberId:objCk.get({name:"ld",key:"MEMBERID"}),lsid:objCk.get({name:"ld",key:"LSID"}),memberSeq:objCk.get({name:"ld",key:"SEQUENCE"})};c=jq.extend(b,c);fnDoTrans({AppC:c.AppC,cmd:"REMOVEMYPAYMENTDETAILS",p1:c.cardId,p2:c.memberId,p3:c.lsid,p4:c.memberSeq,p5:"Y",p6:"Y",p7:"jsa",secure:true,fnCC:function(d){jq.globalEval(unescape(d));if(jq.trim(Status[0][0].toUpperCase())=="TRUE"){if(c.success){c.success(d);}}else{if(c.error){c.error(Status[0][1]+"~"+Status[0][2]);}}},fnEC:function(d){if(c.error){c.error(d);}}});}catch(a){fnErr({fnName:"oMyPay.fnAddPayOpt",fnParams:arguments,err:a});}};oMyPay.fnGetExpDate=function(g,b){try{var a=g.split("-");var c=a[0];var f=a[1];if(b){switch(jq.trim(b.toUpperCase())){case"DASH":return c+"-"+f;break;case"DISP":return f+"/"+c.substring(4,2);break;}}else{return c+""+f;}}catch(d){return"";}};function fnLoginWallet(){try{var a=jq("#txtUserWallet");var c=jq("#txtPassWallet");if(a.val()==""){fnCMsgDis("errDivMW","Please enter an email address!","e");a.focus();return;}else{if(!fnVal.email(a.val())){fnCMsgDis("errDivMW","Please enter a valid email address!","e");a.focus();return;}}if(c.val()==""){fnCMsgDis("errDivMW","Please enter a password!","e");c.focus();return;}jq("#btnLoginWallet").hide();jq("#imgLoginWallet").fadeIn("fast");jq("#txtUserWallet").attr("disabled","disabled");jq("#txtPassWallet").attr("disabled","disabled");fnDoTrans({cmd:"SIGNIN",p1:a.val(),p2:c.val(),fnCC:function(d){objCk.set({name:"ld",value:d});jq("#imgLoginWallet").hide();jq("#btnLoginWallet").show();jq("#txtUserWallet").removeAttr("disabled");jq("#txtPassWallet").removeAttr("disabled");fnListPayOpts();},fnEC:function(d){fnCMsgDis("errDivMW",d,"e");fnBusy(false);jq("#btnLoginWallet").show();jq("#imgLoginWallet").hide();jq("#txtUserWallet").removeAttr("disabled");jq("#txtPassWallet").removeAttr("disabled");}});}catch(b){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:b});}}function fnListPayOpts(){try{jq("#dLoginMyPay").hide();fnBusy(true);oMyPay.fnListPayOpts({success:function(b){fnGenPayList(b);},error:function(d){fnBusy(false);var e=d||"";var c=e.split("~")[0];var b=e.split("~")[1];if(c==-4311||c==-4318||c==-4322||c==-4324||c==-10236){(global.SignInCallBack=global.SignInCallBack||[]).push(function(){fnReqLogin({from:"mypay"});});fnGlobalErr({eCode:"myFLogin",eMess:b+' Click <a class="button blackbtn" href=\'javascript:;\' onclick=\'SignIn.fnSignIn(true);jq("#glErrDiv").slideUp("fast");\'>Here</a> to Login'});}else{fnGlobalErr({eMess:d,eCmd:"LISTMYPAYMENTDETAILS : parameters: {}\n Err: "+d,eRFn:"fnListPayOpts"});}}});}catch(a){fnErr({fnName:arguments.callee.name,fnParams:arguments,err:a});}}function fnGenPayList(j){try{jq.globalEval(unescape(j));var k="";var d="";var h=[];var b=[];var f="";if(objCk.get({name:"userCine",key:"LASTMPID"})!=""){for(var i=0;i<CardDetails.length;i++){if(objCk.get({name:"userCine",key:"LASTMPID"})==CardDetails[i][0]){b=CardDetails[i];break;}}}else{if(CardDetails.length>0){b=CardDetails[0];}}if(b.length>0){switch(jq.trim(b[3].toUpperCase())){case"CD":f+='<div class="'+b[9].toLowerCase()+'"></div>';f+='<div class="cardname" style="margin-left: 20px;">'+b[2]+"</div>";f+='<div class="cardnum">'+fnGVal({data:b[6],key:"CARDNO"})+"</div>";if(b[9].toUpperCase()=="AMEX"){f+='<input type="text" id="pin_QuikPay" autocomplete="off" placeholder="Pin" maxlength="10" class="cvvtxt " value="" />';}f+='<input type="password" id="cvv_QuikPay" autocomplete="off" placeholder="CVV" maxlength="4" class="cvvtxt apin" value="" />';break;case"NB":f+='<div class="qpaybnk"><img src="/img/pay/netbanks/'+b[9]+'" alt="'+b[2]+'" title="'+b[2]+"\" onerror=\"jq(this).parent().append(jq('<span/>').css({ lineHeight: '25px', width: '100px' }).html('"+b[2]+"')); jq(this).remove();\" /></div>";f+='<div class="bnkname">'+b[2]+"</div>";break;}jq("#dSecQuikPay").attr("data-paytype",jq.trim(b[3].toUpperCase()));jq("#dSecQuikPay").attr("data-cardtype",b[9].toUpperCase());jq("#dSecQuikPay").attr("data-payid",b[0]);}if(f==""){jq("#dSecQuikPay [data-role='loading']").hide();jq("#dSecQuikPay").hide();if(jq("#dSecPayOpts").attr("data-mode")=="hide"){fnDoSwitchAcc("dSecPayOpts");}}else{jq("#dSecQuikPay [data-role='list']").html(f).show();jq("#dSecQuikPay [data-role='loading']").hide();}if(jq("#dSecQuikPay").attr("data-mode")=="show"){jq("#spnMorePayOptsTag").html("More Payment Options");jq("#dTMyPay a").html("More QuikPays");}else{jq("#spnMorePayOptsTag").html("Payment Options");jq("#dTMyPay a").html("QuikPays");}for(var i=0;i<CardDetails.length;i++){var c=CardDetails[i];switch(jq.trim(c[3].toUpperCase())){case"CD":k+='<div class="lpaybl">';k+="<div>";k+="<label>";k+='<input type="radio" name="mypay" class="radio" value="'+c[0]+'" data-payid="'+c[0]+'" data-paytype="CD" data-cardtype="'+c[9].toUpperCase()+'" />';k+='<span class="fleft '+c[9].toLowerCase()+'">&nbsp;</span>';k+='<span class="cardname">'+c[2]+"</span>";if(c[9].toLowerCase()=="maestro"){if(c[7]=="204912"||c[7]==""){k+='<p class="cardnum">'+fnGVal({data:c[6],key:"CARDNO"})+"</p>";}else{if(fnGVal({data:c[6],key:"CARDNO"})==""){k+='<p class="cardnum">Exp on '+oMyPay.fnGetExpDate(c[7],"disp")+"</p>";}else{k+='<p class="cardnum">'+fnGVal({data:c[6],key:"CARDNO"})+", Exp on "+oMyPay.fnGetExpDate(c[7],"disp")+"</p>";}}}else{if(fnGVal({data:c[6],key:"CARDNO"})==""){k+='<p class="cardnum">Exp on '+oMyPay.fnGetExpDate(c[7],"disp")+"</p>";}else{k+='<p class="cardnum">'+fnGVal({data:c[6],key:"CARDNO"})+", Exp on "+oMyPay.fnGetExpDate(c[7],"disp")+"</p>";}}k+="</label>";k+="<div>";if(c[9].toUpperCase()=="AMEX"){k+='<div class="cvvnum" style="display: none;">';k+='<input type="text" maxlength="10" id="pin_'+c[0]+'" class="textbox wt55" placeholder="PIN"/>';k+="</div>";}k+='<div class="cvvnum amexpin" style="display: none;">';k+='<input type="password" maxlength="4" id="cvv_'+c[0]+'" class="textbox wt55" placeholder="CVV"/>';k+="</div>";k+="</div>";k+="</div>";k+="</div>";break;case"NB":h.push(c[9]);d+='<div class="banklogo">';d+="<label>";d+='<input type="radio" name="mypay" class="radio" value="'+c[0]+'" data-payid="'+c[0]+'" data-paytype="NB" data-cardtype="'+c[9].toUpperCase()+'" onclick="fnSetNetBank(\''+c[9]+"', 'mypay');\" />";d+='<img src="/img/pay/netbanks/'+c[9]+'" alt="'+c[2]+'" title="'+c[2]+"\" onerror=\"jq(this).parent().append(jq('<span/>').css({ lineHeight: '25px', width: '100px' }).html('"+c[2]+"')); jq(this).remove();\" />";d+="</label>";d+="</div>";break;}}if(k==""){k="<div>You don't have any cards added in your wallet!</div>";}if(d==""){d="<div>You don't have any NetBanking options added in your wallet!</div>";}jq("#dDCList").html(k);jq("#dNBList").html(d);jq("#dListMyPay").animate({height:"show",opacity:"show"},"fast");jq("input[name='mypay']").unbind("change");jq("input[name='mypay']").bind("change",function(a){jq("#dDCList .lpaybl").removeClass("selected");jq("#dNBList .banklogo").removeClass("selected");if(jq(this).attr("data-paytype")=="CD"){jq(this).parents(".lpaybl").addClass("selected");jq("#dDCList .cvvnum, #dDCList .pinnum").hide();jq(this).parents(".lpaybl").find(".cvvnum, .pinnum").fadeIn("fast");}else{if(jq(this).attr("data-paytype")=="NB"){jq(this).parents(".banklogo").addClass("selected");}}objCk.set({name:"userCine",key:"LASTMPID",value:jq(this).data("payid")});});jq(".cvvnum > input[type='textbox'], .pinnum > input[type='textbox']").doEnter({callback:fnPayMyPayments});fnLoadNetBanks();if(jq("#dNetBnksImgs > label").length==0){jq("#dOtherNBTag").html("Select Bank: ");}else{jq("#dOtherNBTag").html("Other Banks: ");}if((typeof(forceTabSwitch)!="undefined"&&forceTabSwitch==true)||CardDetails.length>0){fnSwPayTab("MyPayments");}else{fnSwitchLastPayOpt(CardDetails.length);}jq("#dTMyPay a").removeAttr("onclick");jq("#dListMyPayLoading").hide();fnBusy(false);}catch(g){fnErr({fnName:"fnGenPayList",fnParams:arguments,err:g});}}function fnPayMyPayments(){try{if(fnValUserDetails()){var o=jq("input[name='mypay']:checked").data("paytype");var a=jq("input[name='mypay']:checked").data("cardtype");var h=jq("input[name='mypay']:checked").data("payid");var f="";var c=jq("#chkFB");var m=jq("#imint");var d=jq("#cmbRP");var k=jq("#chkPolicyTick");var n="";var j="";if(jq("input[name='mypay']:checked").length==0){if(jq("#dLoginMyPay").is(":visible")){fnCMsgDis("errDivMW","Please login first to select a payment option!","e");}else{fnCMsgDis("errDivMW","Please select a payment option!","e");}return;}if(jq("#chkLoyPoints").is(":checked")&&d.val()=="imint"){if(m.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");m.focus();return;}if(isNaN(m.val())||(m.val().length==16&&m.val().substring(0,6)!="940115")||m.val().length<10){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");m.focus();return;}if(fnVal.mob(m.val())&&m.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");m.focus();return;}j="|MEMBERTYPE=IMINT|MEMBERNO="+m.val()+"|";}if(c.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&c.is(":checked")){j+=(j==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){j=((j=="")?"|":"")+"ETICKET=Y|";}switch(o){case"CD":var l=jq("#cvv_"+h);var b=jq("#pin_"+h);if(l.val().length<3||isNaN(l.val())){if(a=="MAESTRO"){}else{fnCMsgDis("errDivMW","Please enter a valid CVV Code.","e");l.focus();return;}}if(a=="AMEX"&&(b.val().length<3)){fnCMsgDis("errDivMW","Please enter a valid Pin Code.","e");b.focus();return;}switch(a){case"VISA":case"MASTERCARD":case"MC":case"HDFCDEBIT":case"ICICIDEBIT":n="|TYPE=CREDIT|";if(dcPaymentMode=="2"){n="|TYPE=DEBIT|";}break;case"AMEX":n="|TYPE=AMEX|";break;case"MAESTRO":case"RUPAY":n="|TYPE=PAYUCARD|";break;case"SDC-DIRECT":case"SPG-DIRECT":case"CIT-NA":n="|TYPE=NETBANKING|";break;default:fnCMsgDis("errDivMW","Invalid Payment Type","e");return;}if(a=="MAESTRO"){n+="CARDTYPE=MAESTRO|";}else{n+="CARDTYPE=ICICIDEBIT|";}n+="CVV="+l.val()+"|";n+=(a=="AMEX"?"POSTCODE="+b.val()+"|":"");break;case"NB":var g=a.split("-");if(g[0]=="120"||g[0]=="170"||g[0]=="200"||g[0]=="340"||g[0]=="450"){n="|TYPE=TPSL|";}else{n="|TYPE=NETBANKING|";}break;}if(a=="SPG-DIRECT"){n+="BANKID=SPD|ITEMCODE=DIRECTD|";}else{n+="MPAY=Y|";n+="MPID="+h+"|";n+="MEMBERID="+objCk.get({name:"ld",key:"MEMBERID"})+"|";n+="LSID="+objCk.get({name:"ld",key:"LSID"})+"|";n+="MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|";}if(!k.is(":checked")){fnCMsgDis("errDivMW","Please agree to the Terms and Conditions before continuing ...","e");return;}fnDisableSubmit("PROCESSING",function(){jq("#strPaymentString").val(n);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(j);var e=jq("#frmCreditDtls");e.attr("action",strPGPostUrl);e.submit();});}}catch(i){fnErr({fnName:"fnPayMyPayments",fnParams:arguments,err:i});}}function fnPayLastQuikPay(){try{if(fnValUserDetails()){var o=jq("#dSecQuikPay").data("paytype");var a=jq("#dSecQuikPay").data("cardtype");var h=jq("#dSecQuikPay").data("payid");var f="";var c=jq("#chkFB");var m=jq("#imint");var d=jq("#cmbRP");var k=jq("#chkPolicyTick");var n="";var j="";if(jq("#chkLoyPoints").is(":checked")&&d.val()=="imint"){if(m.val()==""){fnCMsgDis("errDivDPts","Please enter a PAYBACK number.","e");m.focus();return;}if(isNaN(m.val())||(m.val().length==16&&m.val().substring(0,6)!="940115")||m.val().length<10){fnCMsgDis("errDivDPts","Please enter a valid PAYBACK number.","e");m.focus();return;}if(fnVal.mob(m.val())&&m.val()!=jq("#txtMobile").val()){fnCMsgDis("errDivDPts","Please enter your mobile number that is registered with PAYBACK.","e");m.focus();return;}j="|MEMBERTYPE=IMINT|MEMBERNO="+m.val()+"|";}if(c.length!=0&&objCk.get({name:"ld",key:"ISFCONNECTLOGIN"})=="Y"&&c.is(":checked")){j+=(j==""?"|":"")+"PUBLISHTOFB=Y|";}if(isETicket=="Y"){j=((j=="")?"|":"")+"ETICKET=Y|";}switch(o){case"CD":var l=jq("#cvv_QuikPay");var b=jq("#pin_QuikPay");if(l.val().length<3||isNaN(l.val())){if(a=="MAESTRO"){}else{fnCMsgDis("errDivLstQP","Please enter a valid CVV Code.","e");l.focus();return;}}if(a=="AMEX"&&(b.val().length<3)){fnCMsgDis("errDivLstQP","Please enter a valid Pin Code.","e");b.focus();return;}switch(a){case"VISA":case"MASTERCARD":case"MC":case"HDFCDEBIT":case"ICICIDEBIT":n="|TYPE=CREDIT|";if(dcPaymentMode=="2"){n="|TYPE=DEBIT|";}break;case"AMEX":n="|TYPE=AMEX|";break;case"RUPAY":case"MAESTRO":n="|TYPE=PAYUCARD|";break;case"SDC-DIRECT":case"SPG-DIRECT":case"CIT-NA":n="|TYPE=NETBANKING|";break;default:fnCMsgDis("errDivLstQP","Invalid Payment Type","e");return;}if(a=="MAESTRO"){n+="CARDTYPE=MAESTRO|";}else{n+="CARDTYPE=ICICIDEBIT|";}n+="CVV="+l.val()+"|";n+=(a=="AMEX"?"POSTCODE="+b.val()+"|":"");break;case"NB":var g=a.split("-");if(g[0]=="120"||g[0]=="170"||g[0]=="200"||g[0]=="340"||g[0]=="450"){n="|TYPE=TPSL|";}else{n="|TYPE=NETBANKING|";}break;}if(a=="SPG-DIRECT"){n+="BANKID=SPD|ITEMCODE=DIRECTD|";}else{n+="MPAY=Y|";n+="MPID="+h+"|";n+="MEMBERID="+objCk.get({name:"ld",key:"MEMBERID"})+"|";n+="LSID="+objCk.get({name:"ld",key:"LSID"})+"|";n+="MEMBERSEQ="+objCk.get({name:"ld",key:"SEQUENCE"})+"|";}if(!k.is(":checked")){fnCMsgDis("errDivLstQP","Please agree to the Terms and Conditions before continuing ...","e");return;}fnDisableSubmit("PROCESSING",function(){objCk.set({name:"userCine",key:"LASTMPID",value:h});jq("#strPaymentString").val(n);jq("#strBookingAlert").val(fnGetContactDetails());jq("#strTransData").val(j);var e=jq("#frmCreditDtls");e.attr("action",strPGPostUrl);e.submit();});}}catch(i){fnErr({fnName:"fnPayLastQuikPay",fnParams:arguments,err:i});}}